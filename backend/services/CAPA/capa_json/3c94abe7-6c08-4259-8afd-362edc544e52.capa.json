{"meta":{"timestamp":"2025-07-14T05:00:09.469524","version":"9.2.1","argv":["-r","D:\\Whitehat\\web\\YARRAI_Web\\backend\\services\\CAPA\\capa-rules","-s","D:\\Whitehat\\web\\YARRAI_Web\\backend\\services\\CAPA\\capa-sigs","--json","D:\\Whitehat\\web\\YARRAI_Web\\backend\\uploads\\3c94abe7-6c08-4259-8afd-362edc544e52.dll"],"sample":{"md5":"4735645ff6bb2ab5d9bc1515d1c03fe3","sha1":"5a537f43aeff120423646a2c1d8ae777665e8e69","sha256":"e947ad89a87b431798a1511e5ad479810cff8293ee727fe6b3f42df69d6f710a","path":"D:/Whitehat/web/YARRAI_Web/backend/uploads/3c94abe7-6c08-4259-8afd-362edc544e52.dll"},"flavor":"static","analysis":{"format":"pe","arch":"i386","os":"windows","extractor":"VivisectFeatureExtractor","rules":["D:/Whitehat/web/YARRAI_Web/backend/services/CAPA/capa-rules"],"base_address":{"type":"absolute","value":268435456},"layout":{"functions":[{"address":{"type":"absolute","value":268439664},"matched_basic_blocks":[{"address":{"type":"absolute","value":268439664}}]},{"address":{"type":"absolute","value":268439744},"matched_basic_blocks":[{"address":{"type":"absolute","value":268439744}}]},{"address":{"type":"absolute","value":268439808},"matched_basic_blocks":[{"address":{"type":"absolute","value":268439808}},{"address":{"type":"absolute","value":268439869}},{"address":{"type":"absolute","value":268439895}},{"address":{"type":"absolute","value":268439925}}]},{"address":{"type":"absolute","value":268439968},"matched_basic_blocks":[{"address":{"type":"absolute","value":268440026}},{"address":{"type":"absolute","value":268440034}},{"address":{"type":"absolute","value":268440045}},{"address":{"type":"absolute","value":268440081}}]},{"address":{"type":"absolute","value":268440096},"matched_basic_blocks":[{"address":{"type":"absolute","value":268440096}}]},{"address":{"type":"absolute","value":268440176},"matched_basic_blocks":[{"address":{"type":"absolute","value":268440176}}]},{"address":{"type":"absolute","value":268440272},"matched_basic_blocks":[{"address":{"type":"absolute","value":268440288}}]},{"address":{"type":"absolute","value":268440304},"matched_basic_blocks":[{"address":{"type":"absolute","value":268440304}}]},{"address":{"type":"absolute","value":268440400},"matched_basic_blocks":[{"address":{"type":"absolute","value":268440400}},{"address":{"type":"absolute","value":268440415}}]},{"address":{"type":"absolute","value":268440464},"matched_basic_blocks":[{"address":{"type":"absolute","value":268440464}},{"address":{"type":"absolute","value":268440531}}]},{"address":{"type":"absolute","value":268440688},"matched_basic_blocks":[{"address":{"type":"absolute","value":268440688}},{"address":{"type":"absolute","value":268440769}},{"address":{"type":"absolute","value":268440814}},{"address":{"type":"absolute","value":268440836}},{"address":{"type":"absolute","value":268440859}},{"address":{"type":"absolute","value":268440898}},{"address":{"type":"absolute","value":268440928}},{"address":{"type":"absolute","value":268440939}}]},{"address":{"type":"absolute","value":268441024},"matched_basic_blocks":[{"address":{"type":"absolute","value":268441040}},{"address":{"type":"absolute","value":268441069}},{"address":{"type":"absolute","value":268441140}}]},{"address":{"type":"absolute","value":268441152},"matched_basic_blocks":[{"address":{"type":"absolute","value":268441167}}]},{"address":{"type":"absolute","value":268441184},"matched_basic_blocks":[{"address":{"type":"absolute","value":268441222}},{"address":{"type":"absolute","value":268441247}},{"address":{"type":"absolute","value":268441281}},{"address":{"type":"absolute","value":268441306}}]},{"address":{"type":"absolute","value":268441424},"matched_basic_blocks":[{"address":{"type":"absolute","value":268441634}},{"address":{"type":"absolute","value":268441739}},{"address":{"type":"absolute","value":268441775}},{"address":{"type":"absolute","value":268441819}},{"address":{"type":"absolute","value":268441881}}]},{"address":{"type":"absolute","value":268441892},"matched_basic_blocks":[{"address":{"type":"absolute","value":268441894}},{"address":{"type":"absolute","value":268441918}},{"address":{"type":"absolute","value":268442000}},{"address":{"type":"absolute","value":268442185}},{"address":{"type":"absolute","value":268442227}},{"address":{"type":"absolute","value":268442412}},{"address":{"type":"absolute","value":268442426}}]},{"address":{"type":"absolute","value":268441936},"matched_basic_blocks":[{"address":{"type":"absolute","value":268442000}},{"address":{"type":"absolute","value":268442185}},{"address":{"type":"absolute","value":268442227}},{"address":{"type":"absolute","value":268442412}},{"address":{"type":"absolute","value":268442426}}]},{"address":{"type":"absolute","value":268442448},"matched_basic_blocks":[{"address":{"type":"absolute","value":268442448}},{"address":{"type":"absolute","value":268442659}},{"address":{"type":"absolute","value":268442752}}]},{"address":{"type":"absolute","value":268443405},"matched_basic_blocks":[{"address":{"type":"absolute","value":268443432}},{"address":{"type":"absolute","value":268443634}}]},{"address":{"type":"absolute","value":268443411},"matched_basic_blocks":[{"address":{"type":"absolute","value":268443432}},{"address":{"type":"absolute","value":268443634}}]},{"address":{"type":"absolute","value":268443414},"matched_basic_blocks":[{"address":{"type":"absolute","value":268443432}},{"address":{"type":"absolute","value":268443634}}]},{"address":{"type":"absolute","value":268443417},"matched_basic_blocks":[{"address":{"type":"absolute","value":268443432}},{"address":{"type":"absolute","value":268443634}}]},{"address":{"type":"absolute","value":268443421},"matched_basic_blocks":[{"address":{"type":"absolute","value":268443421}},{"address":{"type":"absolute","value":268443634}}]},{"address":{"type":"absolute","value":268443427},"matched_basic_blocks":[{"address":{"type":"absolute","value":268443427}},{"address":{"type":"absolute","value":268443634}}]},{"address":{"type":"absolute","value":268443430},"matched_basic_blocks":[{"address":{"type":"absolute","value":268443430}},{"address":{"type":"absolute","value":268443634}}]},{"address":{"type":"absolute","value":268443599},"matched_basic_blocks":[{"address":{"type":"absolute","value":268443634}}]},{"address":{"type":"absolute","value":268443608},"matched_basic_blocks":[{"address":{"type":"absolute","value":268443634}}]},{"address":{"type":"absolute","value":268443611},"matched_basic_blocks":[{"address":{"type":"absolute","value":268443634}}]},{"address":{"type":"absolute","value":268443614},"matched_basic_blocks":[{"address":{"type":"absolute","value":268443634}}]},{"address":{"type":"absolute","value":268443618},"matched_basic_blocks":[{"address":{"type":"absolute","value":268443634}}]},{"address":{"type":"absolute","value":268443627},"matched_basic_blocks":[{"address":{"type":"absolute","value":268443634}}]},{"address":{"type":"absolute","value":268443630},"matched_basic_blocks":[{"address":{"type":"absolute","value":268443634}}]},{"address":{"type":"absolute","value":268443842},"matched_basic_blocks":[{"address":{"type":"absolute","value":268443926}}]},{"address":{"type":"absolute","value":268444027},"matched_basic_blocks":[{"address":{"type":"absolute","value":268444027}},{"address":{"type":"absolute","value":268444075}},{"address":{"type":"absolute","value":268444090}},{"address":{"type":"absolute","value":268444113}},{"address":{"type":"absolute","value":268444142}}]},{"address":{"type":"absolute","value":268444269},"matched_basic_blocks":[{"address":{"type":"absolute","value":268444318}},{"address":{"type":"absolute","value":268444376}},{"address":{"type":"absolute","value":268444554}}]},{"address":{"type":"absolute","value":268444651},"matched_basic_blocks":[{"address":{"type":"absolute","value":268444684}}]},{"address":{"type":"absolute","value":268444864},"matched_basic_blocks":[{"address":{"type":"absolute","value":268444871}},{"address":{"type":"absolute","value":268444890}}]},{"address":{"type":"absolute","value":268444925},"matched_basic_blocks":[{"address":{"type":"absolute","value":268444925}}]},{"address":{"type":"absolute","value":268445032},"matched_basic_blocks":[{"address":{"type":"absolute","value":268445059}},{"address":{"type":"absolute","value":268445076}}]},{"address":{"type":"absolute","value":268445586},"matched_basic_blocks":[{"address":{"type":"absolute","value":268445604}},{"address":{"type":"absolute","value":268445619}}]},{"address":{"type":"absolute","value":268445629},"matched_basic_blocks":[{"address":{"type":"absolute","value":268445629}},{"address":{"type":"absolute","value":268445802}},{"address":{"type":"absolute","value":268445861}},{"address":{"type":"absolute","value":268445883}},{"address":{"type":"absolute","value":268446182}},{"address":{"type":"absolute","value":268446297}}]},{"address":{"type":"absolute","value":268446421},"matched_basic_blocks":[{"address":{"type":"absolute","value":268446439}},{"address":{"type":"absolute","value":268446474}},{"address":{"type":"absolute","value":268446534}}]},{"address":{"type":"absolute","value":268446604},"matched_basic_blocks":[{"address":{"type":"absolute","value":268446625}},{"address":{"type":"absolute","value":268446653}},{"address":{"type":"absolute","value":268446665}},{"address":{"type":"absolute","value":268446728}},{"address":{"type":"absolute","value":268446784}}]},{"address":{"type":"absolute","value":268447601},"matched_basic_blocks":[{"address":{"type":"absolute","value":268447601}},{"address":{"type":"absolute","value":268447662}},{"address":{"type":"absolute","value":268447703}},{"address":{"type":"absolute","value":268447737}},{"address":{"type":"absolute","value":268447822}},{"address":{"type":"absolute","value":268447897}},{"address":{"type":"absolute","value":268447923}},{"address":{"type":"absolute","value":268447982}},{"address":{"type":"absolute","value":268447989}},{"address":{"type":"absolute","value":268448298}}]},{"address":{"type":"absolute","value":268448471},"matched_basic_blocks":[{"address":{"type":"absolute","value":268448587}},{"address":{"type":"absolute","value":268448634}},{"address":{"type":"absolute","value":268448678}},{"address":{"type":"absolute","value":268448721}},{"address":{"type":"absolute","value":268448764}}]},{"address":{"type":"absolute","value":268448966},"matched_basic_blocks":[{"address":{"type":"absolute","value":268449009}},{"address":{"type":"absolute","value":268449055}}]},{"address":{"type":"absolute","value":268449067},"matched_basic_blocks":[{"address":{"type":"absolute","value":268449137}},{"address":{"type":"absolute","value":268449157}},{"address":{"type":"absolute","value":268449202}},{"address":{"type":"absolute","value":268449233}}]},{"address":{"type":"absolute","value":268450064},"matched_basic_blocks":[{"address":{"type":"absolute","value":268450110}},{"address":{"type":"absolute","value":268450167}}]},{"address":{"type":"absolute","value":268450251},"matched_basic_blocks":[{"address":{"type":"absolute","value":268450302}},{"address":{"type":"absolute","value":268450421}},{"address":{"type":"absolute","value":268450438}},{"address":{"type":"absolute","value":268450464}},{"address":{"type":"absolute","value":268450524}},{"address":{"type":"absolute","value":268450584}},{"address":{"type":"absolute","value":268450632}},{"address":{"type":"absolute","value":268450667}},{"address":{"type":"absolute","value":268450694}},{"address":{"type":"absolute","value":268450756}}]},{"address":{"type":"absolute","value":268450761},"matched_basic_blocks":[{"address":{"type":"absolute","value":268450788}},{"address":{"type":"absolute","value":268450798}},{"address":{"type":"absolute","value":268450823}}]},{"address":{"type":"absolute","value":268450837},"matched_basic_blocks":[{"address":{"type":"absolute","value":268450959}},{"address":{"type":"absolute","value":268450971}}]},{"address":{"type":"absolute","value":268451036},"matched_basic_blocks":[{"address":{"type":"absolute","value":268451062}},{"address":{"type":"absolute","value":268451203}}]},{"address":{"type":"absolute","value":268451400},"matched_basic_blocks":[{"address":{"type":"absolute","value":268451472}}]},{"address":{"type":"absolute","value":268451852},"matched_basic_blocks":[{"address":{"type":"absolute","value":268451904}}]},{"address":{"type":"absolute","value":268451901},"matched_basic_blocks":[{"address":{"type":"absolute","value":268451904}}]},{"address":{"type":"absolute","value":268451920},"matched_basic_blocks":[{"address":{"type":"absolute","value":268451972}}]},{"address":{"type":"absolute","value":268451969},"matched_basic_blocks":[{"address":{"type":"absolute","value":268451972}}]},{"address":{"type":"absolute","value":268451988},"matched_basic_blocks":[{"address":{"type":"absolute","value":268452163}},{"address":{"type":"absolute","value":268452204}}]},{"address":{"type":"absolute","value":268452575},"matched_basic_blocks":[{"address":{"type":"absolute","value":268452575}}]},{"address":{"type":"absolute","value":268452592},"matched_basic_blocks":[{"address":{"type":"absolute","value":268452592}},{"address":{"type":"absolute","value":268452632}},{"address":{"type":"absolute","value":268452664}},{"address":{"type":"absolute","value":268452896}},{"address":{"type":"absolute","value":268453020}}]},{"address":{"type":"absolute","value":268452704},"matched_basic_blocks":[{"address":{"type":"absolute","value":268452704}},{"address":{"type":"absolute","value":268452896}}]},{"address":{"type":"absolute","value":268452748},"matched_basic_blocks":[{"address":{"type":"absolute","value":268452748}},{"address":{"type":"absolute","value":268452896}}]},{"address":{"type":"absolute","value":268452784},"matched_basic_blocks":[{"address":{"type":"absolute","value":268452784}},{"address":{"type":"absolute","value":268452896}}]},{"address":{"type":"absolute","value":268453100},"matched_basic_blocks":[{"address":{"type":"absolute","value":268453100}}]},{"address":{"type":"absolute","value":268453136},"matched_basic_blocks":[{"address":{"type":"absolute","value":268453136}}]},{"address":{"type":"absolute","value":268453176},"matched_basic_blocks":[{"address":{"type":"absolute","value":268453176}}]},{"address":{"type":"absolute","value":268453284},"matched_basic_blocks":[{"address":{"type":"absolute","value":268453284}}]},{"address":{"type":"absolute","value":268453648},"matched_basic_blocks":[{"address":{"type":"absolute","value":268453648}},{"address":{"type":"absolute","value":268453688}},{"address":{"type":"absolute","value":268453720}},{"address":{"type":"absolute","value":268453952}},{"address":{"type":"absolute","value":268454076}}]},{"address":{"type":"absolute","value":268453760},"matched_basic_blocks":[{"address":{"type":"absolute","value":268453760}},{"address":{"type":"absolute","value":268453952}}]},{"address":{"type":"absolute","value":268453804},"matched_basic_blocks":[{"address":{"type":"absolute","value":268453804}},{"address":{"type":"absolute","value":268453952}}]},{"address":{"type":"absolute","value":268453840},"matched_basic_blocks":[{"address":{"type":"absolute","value":268453840}},{"address":{"type":"absolute","value":268453952}}]},{"address":{"type":"absolute","value":268454156},"matched_basic_blocks":[{"address":{"type":"absolute","value":268454156}}]},{"address":{"type":"absolute","value":268454192},"matched_basic_blocks":[{"address":{"type":"absolute","value":268454192}}]},{"address":{"type":"absolute","value":268454232},"matched_basic_blocks":[{"address":{"type":"absolute","value":268454232}}]},{"address":{"type":"absolute","value":268454340},"matched_basic_blocks":[{"address":{"type":"absolute","value":268454340}}]},{"address":{"type":"absolute","value":268455020},"matched_basic_blocks":[{"address":{"type":"absolute","value":268455020}},{"address":{"type":"absolute","value":268455104}},{"address":{"type":"absolute","value":268455114}},{"address":{"type":"absolute","value":268455153}},{"address":{"type":"absolute","value":268455305}},{"address":{"type":"absolute","value":268455352}}]},{"address":{"type":"absolute","value":268455422},"matched_basic_blocks":[{"address":{"type":"absolute","value":268455422}},{"address":{"type":"absolute","value":268455467}},{"address":{"type":"absolute","value":268455556}},{"address":{"type":"absolute","value":268455609}},{"address":{"type":"absolute","value":268455647}},{"address":{"type":"absolute","value":268455734}}]},{"address":{"type":"absolute","value":268455828},"matched_basic_blocks":[{"address":{"type":"absolute","value":268456000}}]},{"address":{"type":"absolute","value":268456208},"matched_basic_blocks":[{"address":{"type":"absolute","value":268456208}},{"address":{"type":"absolute","value":268456243}},{"address":{"type":"absolute","value":268456253}},{"address":{"type":"absolute","value":268456283}}]},{"address":{"type":"absolute","value":268456304},"matched_basic_blocks":[{"address":{"type":"absolute","value":268456421}},{"address":{"type":"absolute","value":268456433}},{"address":{"type":"absolute","value":268456442}},{"address":{"type":"absolute","value":268456457}},{"address":{"type":"absolute","value":268456462}}]},{"address":{"type":"absolute","value":268456320},"matched_basic_blocks":[{"address":{"type":"absolute","value":268456333}},{"address":{"type":"absolute","value":268456352}},{"address":{"type":"absolute","value":268456421}},{"address":{"type":"absolute","value":268456433}},{"address":{"type":"absolute","value":268456442}},{"address":{"type":"absolute","value":268456457}},{"address":{"type":"absolute","value":268456462}}]},{"address":{"type":"absolute","value":268456333},"matched_basic_blocks":[{"address":{"type":"absolute","value":268456333}},{"address":{"type":"absolute","value":268456352}},{"address":{"type":"absolute","value":268456421}},{"address":{"type":"absolute","value":268456433}},{"address":{"type":"absolute","value":268456442}},{"address":{"type":"absolute","value":268456457}},{"address":{"type":"absolute","value":268456462}}]},{"address":{"type":"absolute","value":268456699},"matched_basic_blocks":[{"address":{"type":"absolute","value":268456699}},{"address":{"type":"absolute","value":268456762}}]},{"address":{"type":"absolute","value":268457382},"matched_basic_blocks":[{"address":{"type":"absolute","value":268457411}},{"address":{"type":"absolute","value":268457432}},{"address":{"type":"absolute","value":268457472}}]},{"address":{"type":"absolute","value":268457530},"matched_basic_blocks":[{"address":{"type":"absolute","value":268457530}}]},{"address":{"type":"absolute","value":268458049},"matched_basic_blocks":[{"address":{"type":"absolute","value":268458062}}]},{"address":{"type":"absolute","value":268458680},"matched_basic_blocks":[{"address":{"type":"absolute","value":268458745}},{"address":{"type":"absolute","value":268458755}},{"address":{"type":"absolute","value":268458851}},{"address":{"type":"absolute","value":268458922}},{"address":{"type":"absolute","value":268459049}}]},{"address":{"type":"absolute","value":268458901},"matched_basic_blocks":[{"address":{"type":"absolute","value":268458922}}]},{"address":{"type":"absolute","value":268459136},"matched_basic_blocks":[{"address":{"type":"absolute","value":268459147}},{"address":{"type":"absolute","value":268459181}}]},{"address":{"type":"absolute","value":268459264},"matched_basic_blocks":[{"address":{"type":"absolute","value":268459332}},{"address":{"type":"absolute","value":268459366}},{"address":{"type":"absolute","value":268459374}},{"address":{"type":"absolute","value":268459475}},{"address":{"type":"absolute","value":268459681}},{"address":{"type":"absolute","value":268459931}},{"address":{"type":"absolute","value":268459990}},{"address":{"type":"absolute","value":268460064}},{"address":{"type":"absolute","value":268460117}}]},{"address":{"type":"absolute","value":268459514},"matched_basic_blocks":[{"address":{"type":"absolute","value":268459681}}]},{"address":{"type":"absolute","value":268460029},"matched_basic_blocks":[{"address":{"type":"absolute","value":268460064}},{"address":{"type":"absolute","value":268460117}}]},{"address":{"type":"absolute","value":268460306},"matched_basic_blocks":[{"address":{"type":"absolute","value":268460461}},{"address":{"type":"absolute","value":268460488}},{"address":{"type":"absolute","value":268460529}}]},{"address":{"type":"absolute","value":268460640},"matched_basic_blocks":[{"address":{"type":"absolute","value":268460660}},{"address":{"type":"absolute","value":268460674}}]},{"address":{"type":"absolute","value":268460718},"matched_basic_blocks":[{"address":{"type":"absolute","value":268460754}},{"address":{"type":"absolute","value":268460841}},{"address":{"type":"absolute","value":268460871}},{"address":{"type":"absolute","value":268460893}}]},{"address":{"type":"absolute","value":268460927},"matched_basic_blocks":[{"address":{"type":"absolute","value":268460952}},{"address":{"type":"absolute","value":268460965}}]},{"address":{"type":"absolute","value":268461136},"matched_basic_blocks":[{"address":{"type":"absolute","value":268461304}},{"address":{"type":"absolute","value":268461376}}]},{"address":{"type":"absolute","value":268461353},"matched_basic_blocks":[{"address":{"type":"absolute","value":268461376}}]},{"address":{"type":"absolute","value":268461599},"matched_basic_blocks":[{"address":{"type":"absolute","value":268461651}},{"address":{"type":"absolute","value":268461676}}]},{"address":{"type":"absolute","value":268461792},"matched_basic_blocks":[{"address":{"type":"absolute","value":268461832}},{"address":{"type":"absolute","value":268461846}},{"address":{"type":"absolute","value":268461856}}]}]},"feature_counts":{"file":658,"functions":[{"address":{"type":"absolute","value":268439552},"count":15},{"address":{"type":"absolute","value":268439584},"count":13},{"address":{"type":"absolute","value":268439616},"count":24},{"address":{"type":"absolute","value":268439664},"count":13},{"address":{"type":"absolute","value":268439696},"count":25},{"address":{"type":"absolute","value":268439744},"count":38},{"address":{"type":"absolute","value":268439808},"count":84},{"address":{"type":"absolute","value":268439968},"count":78},{"address":{"type":"absolute","value":268440096},"count":43},{"address":{"type":"absolute","value":268440176},"count":48},{"address":{"type":"absolute","value":268440272},"count":27},{"address":{"type":"absolute","value":268440304},"count":27},{"address":{"type":"absolute","value":268440352},"count":7},{"address":{"type":"absolute","value":268440368},"count":19},{"address":{"type":"absolute","value":268440400},"count":28},{"address":{"type":"absolute","value":268440464},"count":85},{"address":{"type":"absolute","value":268440688},"count":84},{"address":{"type":"absolute","value":268440960},"count":39},{"address":{"type":"absolute","value":268441024},"count":47},{"address":{"type":"absolute","value":268441152},"count":22},{"address":{"type":"absolute","value":268441184},"count":59},{"address":{"type":"absolute","value":268441344},"count":7},{"address":{"type":"absolute","value":268441350},"count":7},{"address":{"type":"absolute","value":268441356},"count":7},{"address":{"type":"absolute","value":268441362},"count":7},{"address":{"type":"absolute","value":268441368},"count":7},{"address":{"type":"absolute","value":268441374},"count":7},{"address":{"type":"absolute","value":268441380},"count":7},{"address":{"type":"absolute","value":268441386},"count":7},{"address":{"type":"absolute","value":268441392},"count":7},{"address":{"type":"absolute","value":268441398},"count":7},{"address":{"type":"absolute","value":268441404},"count":7},{"address":{"type":"absolute","value":268441424},"count":112},{"address":{"type":"absolute","value":268441892},"count":77},{"address":{"type":"absolute","value":268441936},"count":71},{"address":{"type":"absolute","value":268442448},"count":34},{"address":{"type":"absolute","value":268443405},"count":42},{"address":{"type":"absolute","value":268443411},"count":34},{"address":{"type":"absolute","value":268443414},"count":32},{"address":{"type":"absolute","value":268443417},"count":31},{"address":{"type":"absolute","value":268443421},"count":40},{"address":{"type":"absolute","value":268443427},"count":33},{"address":{"type":"absolute","value":268443430},"count":31},{"address":{"type":"absolute","value":268443599},"count":26},{"address":{"type":"absolute","value":268443608},"count":19},{"address":{"type":"absolute","value":268443611},"count":17},{"address":{"type":"absolute","value":268443614},"count":17},{"address":{"type":"absolute","value":268443618},"count":26},{"address":{"type":"absolute","value":268443627},"count":19},{"address":{"type":"absolute","value":268443630},"count":17},{"address":{"type":"absolute","value":268443724},"count":43},{"address":{"type":"absolute","value":268443729},"count":43},{"address":{"type":"absolute","value":268443812},"count":15},{"address":{"type":"absolute","value":268443842},"count":53},{"address":{"type":"absolute","value":268443953},"count":15},{"address":{"type":"absolute","value":268443956},"count":15},{"address":{"type":"absolute","value":268444027},"count":39},{"address":{"type":"absolute","value":268444155},"count":26},{"address":{"type":"absolute","value":268444195},"count":24},{"address":{"type":"absolute","value":268444245},"count":11},{"address":{"type":"absolute","value":268444269},"count":87},{"address":{"type":"absolute","value":268444651},"count":39},{"address":{"type":"absolute","value":268444864},"count":30},{"address":{"type":"absolute","value":268444925},"count":25},{"address":{"type":"absolute","value":268444951},"count":38},{"address":{"type":"absolute","value":268445032},"count":54},{"address":{"type":"absolute","value":268445338},"count":46},{"address":{"type":"absolute","value":268445586},"count":32},{"address":{"type":"absolute","value":268445629},"count":123},{"address":{"type":"absolute","value":268446421},"count":62},{"address":{"type":"absolute","value":268446604},"count":119},{"address":{"type":"absolute","value":268447601},"count":111},{"address":{"type":"absolute","value":268448427},"count":13},{"address":{"type":"absolute","value":268448444},"count":19},{"address":{"type":"absolute","value":268448471},"count":61},{"address":{"type":"absolute","value":268448823},"count":17},{"address":{"type":"absolute","value":268448831},"count":15},{"address":{"type":"absolute","value":268448900},"count":24},{"address":{"type":"absolute","value":268448966},"count":37},{"address":{"type":"absolute","value":268449067},"count":55},{"address":{"type":"absolute","value":268449310},"count":48},{"address":{"type":"absolute","value":268449416},"count":15},{"address":{"type":"absolute","value":268449419},"count":15},{"address":{"type":"absolute","value":268449458},"count":16},{"address":{"type":"absolute","value":268449477},"count":43},{"address":{"type":"absolute","value":268449590},"count":76},{"address":{"type":"absolute","value":268449929},"count":15},{"address":{"type":"absolute","value":268449941},"count":15},{"address":{"type":"absolute","value":268449944},"count":15},{"address":{"type":"absolute","value":268449953},"count":45},{"address":{"type":"absolute","value":268450064},"count":57},{"address":{"type":"absolute","value":268450231},"count":15},{"address":{"type":"absolute","value":268450234},"count":15},{"address":{"type":"absolute","value":268450251},"count":133},{"address":{"type":"absolute","value":268450761},"count":52},{"address":{"type":"absolute","value":268450837},"count":50},{"address":{"type":"absolute","value":268451036},"count":62},{"address":{"type":"absolute","value":268451400},"count":49},{"address":{"type":"absolute","value":268451852},"count":38},{"address":{"type":"absolute","value":268451897},"count":8},{"address":{"type":"absolute","value":268451901},"count":31},{"address":{"type":"absolute","value":268451920},"count":37},{"address":{"type":"absolute","value":268451965},"count":8},{"address":{"type":"absolute","value":268451969},"count":31},{"address":{"type":"absolute","value":268451988},"count":86},{"address":{"type":"absolute","value":268452436},"count":42},{"address":{"type":"absolute","value":268452529},"count":11},{"address":{"type":"absolute","value":268452543},"count":22},{"address":{"type":"absolute","value":268452575},"count":15},{"address":{"type":"absolute","value":268452592},"count":63},{"address":{"type":"absolute","value":268452704},"count":51},{"address":{"type":"absolute","value":268452748},"count":46},{"address":{"type":"absolute","value":268452784},"count":53},{"address":{"type":"absolute","value":268453100},"count":34},{"address":{"type":"absolute","value":268453136},"count":35},{"address":{"type":"absolute","value":268453176},"count":44},{"address":{"type":"absolute","value":268453284},"count":27},{"address":{"type":"absolute","value":268453648},"count":63},{"address":{"type":"absolute","value":268453760},"count":51},{"address":{"type":"absolute","value":268453804},"count":46},{"address":{"type":"absolute","value":268453840},"count":53},{"address":{"type":"absolute","value":268454156},"count":34},{"address":{"type":"absolute","value":268454192},"count":35},{"address":{"type":"absolute","value":268454232},"count":44},{"address":{"type":"absolute","value":268454340},"count":27},{"address":{"type":"absolute","value":268454477},"count":41},{"address":{"type":"absolute","value":268454679},"count":42},{"address":{"type":"absolute","value":268454873},"count":25},{"address":{"type":"absolute","value":268454923},"count":15},{"address":{"type":"absolute","value":268454979},"count":15},{"address":{"type":"absolute","value":268455020},"count":93},{"address":{"type":"absolute","value":268455422},"count":97},{"address":{"type":"absolute","value":268455828},"count":78},{"address":{"type":"absolute","value":268456208},"count":59},{"address":{"type":"absolute","value":268456320},"count":72},{"address":{"type":"absolute","value":268456699},"count":59},{"address":{"type":"absolute","value":268457281},"count":8},{"address":{"type":"absolute","value":268457301},"count":24},{"address":{"type":"absolute","value":268457382},"count":54},{"address":{"type":"absolute","value":268457530},"count":19},{"address":{"type":"absolute","value":268457954},"count":21},{"address":{"type":"absolute","value":268458049},"count":33},{"address":{"type":"absolute","value":268458680},"count":66},{"address":{"type":"absolute","value":268458897},"count":8},{"address":{"type":"absolute","value":268458901},"count":37},{"address":{"type":"absolute","value":268459136},"count":27},{"address":{"type":"absolute","value":268459264},"count":76},{"address":{"type":"absolute","value":268459510},"count":8},{"address":{"type":"absolute","value":268459514},"count":49},{"address":{"type":"absolute","value":268459716},"count":8},{"address":{"type":"absolute","value":268459720},"count":31},{"address":{"type":"absolute","value":268460025},"count":8},{"address":{"type":"absolute","value":268460029},"count":31},{"address":{"type":"absolute","value":268460220},"count":27},{"address":{"type":"absolute","value":268460306},"count":81},{"address":{"type":"absolute","value":268460365},"count":8},{"address":{"type":"absolute","value":268460640},"count":39},{"address":{"type":"absolute","value":268460718},"count":64},{"address":{"type":"absolute","value":268460927},"count":64},{"address":{"type":"absolute","value":268461063},"count":34},{"address":{"type":"absolute","value":268461136},"count":59},{"address":{"type":"absolute","value":268461349},"count":8},{"address":{"type":"absolute","value":268461353},"count":34},{"address":{"type":"absolute","value":268461599},"count":53},{"address":{"type":"absolute","value":268461792},"count":40},{"address":{"type":"absolute","value":268462270},"count":7},{"address":{"type":"absolute","value":268462288},"count":14},{"address":{"type":"absolute","value":268462320},"count":19}]},"library_functions":[{"address":{"type":"absolute","value":268439600},"name":"?"},{"address":{"type":"absolute","value":268443715},"name":"__purecall"},{"address":{"type":"absolute","value":268443965},"name":"__nh_malloc"},{"address":{"type":"absolute","value":268444009},"name":"_malloc"},{"address":{"type":"absolute","value":268444251},"name":"_atexit"},{"address":{"type":"absolute","value":268444808},"name":"__amsg_exit"},{"address":{"type":"absolute","value":268445159},"name":"__mtinitlocks"},{"address":{"type":"absolute","value":268445232},"name":"__mtdeletelocks"},{"address":{"type":"absolute","value":268445317},"name":"__unlock"},{"address":{"type":"absolute","value":268445465},"name":"__lock"},{"address":{"type":"absolute","value":268445514},"name":"___sbh_heap_init"},{"address":{"type":"absolute","value":268446866},"name":"___sbh_resize_block"},{"address":{"type":"absolute","value":268448368},"name":"__SEH_prolog"},{"address":{"type":"absolute","value":268448948},"name":"__lockexit"},{"address":{"type":"absolute","value":268448957},"name":"__unlockexit"},{"address":{"type":"absolute","value":268449278},"name":"__exit"},{"address":{"type":"absolute","value":268449295},"name":"__cexit"},{"address":{"type":"absolute","value":268449428},"name":"__mtterm"},{"address":{"type":"absolute","value":268449932},"name":"__unlockexit"},{"address":{"type":"absolute","value":268451562},"name":"___crtGetEnvironmentStringsA"},{"address":{"type":"absolute","value":268452363},"name":"__FF_MSGBANNER"},{"address":{"type":"absolute","value":268452420},"name":"___crtInitCritSecNoSpinCount@8"},{"address":{"type":"absolute","value":268453432},"name":"__except_handler3"},{"address":{"type":"absolute","value":268454932},"name":"?CPtoLCID@@YAHH@Z"},{"address":{"type":"absolute","value":268456155},"name":"__unlockexit"},{"address":{"type":"absolute","value":268456164},"name":"___initmbctable"},{"address":{"type":"absolute","value":268456304},"name":"_strcpy"},{"address":{"type":"absolute","value":268456333},"name":"dest_misaligned"},{"address":{"type":"absolute","value":268456560},"name":"_strlen"},{"address":{"type":"absolute","value":268456960},"name":"_strncpy"},{"address":{"type":"absolute","value":268457316},"name":"__global_unwind2"},{"address":{"type":"absolute","value":268457348},"name":"__unwind_handler"},{"address":{"type":"absolute","value":268457554},"name":"?"},{"address":{"type":"absolute","value":268458272},"name":"_strcspn"},{"address":{"type":"absolute","value":268459200},"name":"_strpbrk"}]}},"rules":{"link function at runtime on Windows":{"meta":{"name":"link function at runtime on Windows","namespace":"linking/runtime-linking","authors":["moritz.raabe@mandiant.com","mehunhoff@google.com"],"scopes":{"static":"instruction","dynamic":"call"},"attack":[{"parts":["Execution","Shared Modules"],"tactic":"Execution","technique":"Shared Modules","subtechnique":"","id":"T1129"}],"mbc":[],"references":[],"examples":["9324D1A8AE37A36AE560C37448C9705A:0x404130","Practical Malware Analysis Lab 01-04.exe_:0x401350"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\r\n  meta:\r\n    name: link function at runtime on Windows\r\n    namespace: linking/runtime-linking\r\n    authors:\r\n      - moritz.raabe@mandiant.com\r\n      - mehunhoff@google.com\r\n    scopes:\r\n      static: instruction\r\n      dynamic: call\r\n    att&ck:\r\n      - Execution::Shared Modules [T1129]\r\n    examples:\r\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404130\r\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\r\n  features:\r\n    - and:\r\n      - os: windows\r\n      - or:\r\n        - api: kernel32.GetProcAddress\r\n        - api: ntdll.LdrGetProcedureAddress\r\n        - api: ntdll.LdrGetProcedureAddressEx\r\n        - api: ntdll.LdrGetProcedureAddressForCaller\r\n        - api: MmGetSystemRoutineAddress\r\n","matches":[[{"type":"absolute","value":268448921},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":268448921}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressForCaller"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MmGetSystemRoutineAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268452487},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":268452487}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressForCaller"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MmGetSystemRoutineAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268456751},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":268456751}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressForCaller"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MmGetSystemRoutineAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268456768},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":268456768}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressForCaller"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MmGetSystemRoutineAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268456781},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":268456781}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressForCaller"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MmGetSystemRoutineAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268456803},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":268456803}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressForCaller"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MmGetSystemRoutineAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268456820},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":268456820}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressForCaller"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MmGetSystemRoutineAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"calculate modulo 256 via x86 assembly":{"meta":{"name":"calculate modulo 256 via x86 assembly","authors":["moritz.raabe@mandiant.com"],"scopes":{"static":"instruction"},"attack":[],"mbc":[{"parts":["Data","Modulo"],"objective":"Data","behavior":"Modulo","method":"","id":"C0058"}],"references":[],"examples":["9324D1A8AE37A36AE560C37448C9705A:0x4049A9"],"description":"","lib":true,"is_subscope_rule":false,"maec":{}},"source":"rule:\r\n  meta:\r\n    name: calculate modulo 256 via x86 assembly\r\n    authors:\r\n      - moritz.raabe@mandiant.com\r\n    lib: true\r\n    scopes:\r\n      static: instruction\r\n      dynamic: unsupported  # requires mnemonic features\r\n    mbc:\r\n      - Data::Modulo [C0058]\r\n    examples:\r\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4049A9\r\n  features:\r\n    #  and ecx, 800000FFh\r\n    #  and ecx, 0FFh\r\n    - and:\r\n      - or:\r\n        - arch: i386\r\n        - arch: amd64\r\n      - mnemonic: and\r\n      - or:\r\n        - number: 0x800000FF\r\n        - number: 0xFF\r\n","matches":[[{"type":"absolute","value":268450667},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"and"}},"children":[],"locations":[{"type":"absolute","value":268450667}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2147483903}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[{"type":"absolute","value":268450667}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"create TCP socket":{"meta":{"name":"create TCP socket","namespace":"communication/socket/tcp","authors":["william.ballenthin@mandiant.com","joakim@intezer.com","anushka.virgaonkar@mandiant.com","michael.hunhoff@mandiant.com"],"scopes":{"static":"basic block","dynamic":"call"},"attack":[],"mbc":[{"parts":["Communication","Socket Communication","Create TCP Socket"],"objective":"Communication","behavior":"Socket Communication","method":"Create TCP Socket","id":"C0001.011"}],"references":["https://learn.microsoft.com/en-us/windows/win32/api/winsock2/nf-winsock2-socket","https://man7.org/linux/man-pages/man2/socket.2.html"],"examples":["Practical Malware Analysis Lab 01-01.dll_:0x10001010"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\r\n  meta:\r\n    name: create TCP socket\r\n    namespace: communication/socket/tcp\r\n    authors:\r\n      - william.ballenthin@mandiant.com\r\n      - joakim@intezer.com\r\n      - anushka.virgaonkar@mandiant.com\r\n      - michael.hunhoff@mandiant.com\r\n    scopes:\r\n      static: basic block\r\n      dynamic: call\r\n    mbc:\r\n      - Communication::Socket Communication::Create TCP Socket [C0001.011]\r\n    references:\r\n      - https://learn.microsoft.com/en-us/windows/win32/api/winsock2/nf-winsock2-socket\r\n      - https://man7.org/linux/man-pages/man2/socket.2.html\r\n    examples:\r\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\r\n  features:\r\n    - or:\r\n      - and:\r\n        - or:\r\n          - number: 0 = protocol (default)\r\n          - number: 6 = IPPROTO_TCP\r\n        - number: 1 = SOCK_STREAM\r\n        - number: 2 = AF_INET\r\n        - or:\r\n          - api: socket\r\n          - api: ws2_32.socket\r\n          - api: ws2_32.#23 = socket\r\n          - api: ws2_32.WSASocket\r\n          - api: ws2_32.#82 = WSASocketA\r\n          - api: ws2_32.#83 = WSASocketW\r\n          - api: System.Net.Sockets.Socket::ctor\r\n      - property/read: System.Net.Sockets.TcpClient::Client\r\n","matches":[[{"type":"absolute","value":268440464},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.Net.Sockets.TcpClient::Client"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":0,"description":"protocol (default)"}},"children":[],"locations":[{"type":"absolute","value":268440488}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":6,"description":"IPPROTO_TCP"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":1,"description":"SOCK_STREAM"}},"children":[],"locations":[{"type":"absolute","value":268440490}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":2,"description":"AF_INET"}},"children":[],"locations":[{"type":"absolute","value":268440492}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"socket"}},"children":[],"locations":[{"type":"absolute","value":268440494}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#23","description":"socket"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WSASocket"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#82","description":"WSASocketA"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#83","description":"WSASocketW"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::ctor"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"create UDP socket":{"meta":{"name":"create UDP socket","namespace":"communication/socket/udp/send","authors":["moritz.raabe@mandiant.com","joakim@intezer.com","michael.hunhoff@mandiant.com"],"scopes":{"static":"basic block","dynamic":"call"},"attack":[],"mbc":[{"parts":["Communication","Socket Communication","Create UDP Socket"],"objective":"Communication","behavior":"Socket Communication","method":"Create UDP Socket","id":"C0001.010"}],"references":["https://learn.microsoft.com/en-us/windows/win32/api/winsock2/nf-winsock2-socket","https://man7.org/linux/man-pages/man2/socket.2.html"],"examples":[],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\r\n  meta:\r\n    name: create UDP socket\r\n    namespace: communication/socket/udp/send\r\n    authors:\r\n      - moritz.raabe@mandiant.com\r\n      - joakim@intezer.com\r\n      - michael.hunhoff@mandiant.com\r\n    scopes:\r\n      static: basic block\r\n      dynamic: call\r\n    mbc:\r\n      - Communication::Socket Communication::Create UDP Socket [C0001.010]\r\n    references:\r\n      - https://learn.microsoft.com/en-us/windows/win32/api/winsock2/nf-winsock2-socket\r\n      - https://man7.org/linux/man-pages/man2/socket.2.html\r\n  features:\r\n    - or:\r\n      - and:\r\n        - number: 2 = AF_INET\r\n        - number: 2 = SOCK_DGRAM\r\n        - or:\r\n          - number: 0 = protocol (default)\r\n          - number: 17 = IPPROTO_UDP\r\n        - or:\r\n          - api: socket\r\n          - api: ws2_32.socket\r\n          - api: ws2_32.#23 = socket\r\n          - api: ws2_32.WSASocket\r\n          - api: ws2_32.#82 = WSASocketA\r\n          - api: ws2_32.#83 = WSASocketW\r\n          - api: System.Net.Sockets.Socket::ctor\r\n      - api: System.Net.Sockets.UdpClient::ctor\r\n","matches":[[{"type":"absolute","value":268440464},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.UdpClient::ctor"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":2,"description":"AF_INET"}},"children":[],"locations":[{"type":"absolute","value":268440492}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":0,"description":"protocol (default)"}},"children":[],"locations":[{"type":"absolute","value":268440488}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":17,"description":"IPPROTO_UDP"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"socket"}},"children":[],"locations":[{"type":"absolute","value":268440494}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#23","description":"socket"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WSASocket"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#82","description":"WSASocketA"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#83","description":"WSASocketW"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::ctor"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"connect socket":{"meta":{"name":"connect socket","namespace":"communication/socket","authors":["moritz.raabe@mandiant.com","joakim@intezer.com","mrhafizfarhad@gmail.com"],"scopes":{"static":"basic block","dynamic":"span of calls"},"attack":[],"mbc":[],"references":[],"examples":["Practical Malware Analysis Lab 01-01.dll_:0x10001010"],"description":"Detects socket connection attempts using common APIs or ConnectEx setup.","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\r\n  meta:\r\n    name: connect socket\r\n    namespace: communication/socket\r\n    authors:\r\n      - moritz.raabe@mandiant.com\r\n      - joakim@intezer.com\r\n      - mrhafizfarhad@gmail.com\r\n    description: Detects socket connection attempts using common APIs or ConnectEx setup.\r\n    scopes:\r\n      static: basic block\r\n      dynamic: span of calls\r\n    examples:\r\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\r\n  features:\r\n    - or:\r\n      - api: connect\r\n      - api: ws2_32.connect\r\n      - api: ws2_32.#4 = connect\r\n      - api: ws2_32.WSAConnect\r\n      - api: ws2_32.#33 = WSAConnect\r\n      - api: ConnectEx\r\n      - or:\r\n        - and:\r\n          # static\r\n          - basic block:\r\n            # candidate for GUID: WSAID_CONNECTEX/25a207b9-ddf3-4660-8ee9-76e58c74063e\r\n            - and:\r\n              - number: 0x25A207B9\r\n              - number: 0x4660DDF3\r\n              - number: 0xE576E98E\r\n              - number: 0x3E06748C\r\n          - basic block:\r\n            - and:\r\n              - or:\r\n                - api: ws2_32.WSAIoctl\r\n                - api: ws2_32.#60 = WSAIoctl\r\n              - number: 0xC8000006 = SIO_GET_EXTENSION_FUNCTION_POINTER\r\n          - basic block:\r\n            - and:\r\n              - or:\r\n                - api: setsockopt\r\n                - api: ws2_32.#21 = setsockopt\r\n              - number: 0xFFFF = SOL_SOCKET\r\n              - number: 0x7010 = SO_UPDATE_CONNECT_CONTEXT\r\n          # socket must be bound to ConnectEx\r\n          # https://gist.github.com/joeyadams/4158972\r\n          - or:\r\n            - api: bind\r\n            - api: ws2_32.#2 = bind\r\n        - and:\r\n          # dynamic\r\n          - call:\r\n            - and:\r\n              - or:\r\n                - api: ws2_32.WSAIoctl\r\n                - api: ws2_32.#60 = WSAIoctl\r\n              - number: 0xC8000006 = SIO_GET_EXTENSION_FUNCTION_POINTER\r\n          - call:\r\n            - and:\r\n              - or:\r\n                - api: setsockopt\r\n                - api: ws2_32.#21 = setsockopt\r\n              - number: 0xFFFF = SOL_SOCKET\r\n              - number: 0x7010 = SO_UPDATE_CONNECT_CONTEXT\r\n          # socket must be bound to ConnectEx\r\n          # https://gist.github.com/joeyadams/4158972\r\n          - or:\r\n            - api: bind\r\n            - api: ws2_32.#2 = bind\r\n","matches":[[{"type":"absolute","value":268440531},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"connect"}},"children":[],"locations":[{"type":"absolute","value":268440594}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#4","description":"connect"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WSAConnect"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#33","description":"WSAConnect"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ConnectEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"connect socket/de796298ea8f4ca29b57757a42ca5d41"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"connect socket/1ed91bf416dc4f01908ac5f7906e2b00"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"connect socket/8395f4ba8695422cb384d376d8f23495"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"bind"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#2","description":"bind"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"connect socket/8361849cad2140ee91749b6b52c6d28b"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"connect socket/335655aa8c574140818096171ecc3606"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"bind"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#2","description":"bind"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"allocate memory":{"meta":{"name":"allocate memory","authors":["0x534a@mailbox.org","@mr-tz"],"scopes":{"static":"basic block","dynamic":"call"},"attack":[],"mbc":[{"parts":["Memory","Allocate Memory"],"objective":"Memory","behavior":"Allocate Memory","method":"","id":"C0007"}],"references":[],"examples":["Practical Malware Analysis Lab 03-03.exe_:0x4010EA","563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA"],"description":"","lib":true,"is_subscope_rule":false,"maec":{}},"source":"rule:\r\n  meta:\r\n    name: allocate memory\r\n    authors:\r\n      - 0x534a@mailbox.org\r\n      - \"@mr-tz\"\r\n    lib: true\r\n    scopes:\r\n      static: basic block\r\n      dynamic: call\r\n    mbc:\r\n      - Memory::Allocate Memory [C0007]\r\n    examples:\r\n      - Practical Malware Analysis Lab 03-03.exe_:0x4010EA\r\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA  # ntdll.NtAllocateVirtualMemory\r\n  features:\r\n    - or:\r\n      - api: kernel32.VirtualAlloc\r\n      - api: kernel32.VirtualAllocEx\r\n      - api: kernel32.VirtualAllocExNuma\r\n      - api: NtAllocateVirtualMemory\r\n      - api: ZwAllocateVirtualMemory\r\n      - api: NtMapViewOfSection\r\n      - api: ZwMapViewOfSection\r\n      - basic block:\r\n        - and:\r\n          - match: link function at runtime on Windows\r\n          - or:\r\n            - string: \"VirtualAlloc\"\r\n            - string: \"VirtualAllocEx\"\r\n            - string: \"VirtualAllocExNuma\"\r\n            - string: \"NtAllocateVirtualMemory\"\r\n            - string: \"ZwAllocateVirtualMemory\"\r\n            - string: \"NtMapViewOfSection\"\r\n            - string: \"ZwMapViewOfSection\"\r\n","matches":[[{"type":"absolute","value":268446534},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAlloc"}},"children":[],"locations":[{"type":"absolute","value":268446547}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocExNuma"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory/a11c5e4fddc6403888b1bdcd83ef538a"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268446665},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAlloc"}},"children":[],"locations":[{"type":"absolute","value":268446686}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocExNuma"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory/a11c5e4fddc6403888b1bdcd83ef538a"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268460871},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAlloc"}},"children":[],"locations":[{"type":"absolute","value":268460878}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocExNuma"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory/a11c5e4fddc6403888b1bdcd83ef538a"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"allocate or change RW memory":{"meta":{"name":"allocate or change RW memory","authors":["0x534a@mailbox.org","@mr-tz"],"scopes":{"static":"basic block","dynamic":"call"},"attack":[],"mbc":[{"parts":["Memory","Allocate Memory"],"objective":"Memory","behavior":"Allocate Memory","method":"","id":"C0007"}],"references":[],"examples":["Practical Malware Analysis Lab 17-02.dll_:0x1000D10D"],"description":"","lib":true,"is_subscope_rule":false,"maec":{}},"source":"rule:\r\n  meta:\r\n    name: allocate or change RW memory\r\n    authors:\r\n      - 0x534a@mailbox.org\r\n      - \"@mr-tz\"\r\n    lib: true\r\n    scopes:\r\n      static: basic block\r\n      dynamic: call\r\n    mbc:\r\n      - Memory::Allocate Memory [C0007]\r\n    examples:\r\n      - Practical Malware Analysis Lab 17-02.dll_:0x1000D10D\r\n  features:\r\n    - and:\r\n      - or:\r\n        - match: allocate memory\r\n        - match: change memory protection\r\n      - or:\r\n        - number: 0x4 = PAGE_READWRITE\r\n        # lea     r9d, [rcx+4]  ; flProtect\r\n        # call    cs:VirtualAlloc\r\n        - instruction:\r\n          - mnemonic: lea\r\n          - offset: 0x4 = PAGE_READWRITE\r\n","matches":[[{"type":"absolute","value":268446534},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAlloc"}},"children":[],"locations":[{"type":"absolute","value":268446547}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocExNuma"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory/a11c5e4fddc6403888b1bdcd83ef538a"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":268446534}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"change memory protection"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":4,"description":"PAGE_READWRITE"}},"children":[],"locations":[{"type":"absolute","value":268446534}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate or change RW memory/9c2e51f1eb3341c28848d5d36b9d2423"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268446665},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAlloc"}},"children":[],"locations":[{"type":"absolute","value":268446686}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocExNuma"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory/a11c5e4fddc6403888b1bdcd83ef538a"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":268446665}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"change memory protection"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":4,"description":"PAGE_READWRITE"}},"children":[],"locations":[{"type":"absolute","value":268446665}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate or change RW memory/9c2e51f1eb3341c28848d5d36b9d2423"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268460871},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAlloc"}},"children":[],"locations":[{"type":"absolute","value":268460878}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocExNuma"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory/a11c5e4fddc6403888b1bdcd83ef538a"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":268460871}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"change memory protection"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":4,"description":"PAGE_READWRITE"}},"children":[],"locations":[{"type":"absolute","value":268460871}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate or change RW memory/9c2e51f1eb3341c28848d5d36b9d2423"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"change memory protection":{"meta":{"name":"change memory protection","authors":["@mr-tz"],"scopes":{"static":"basic block","dynamic":"call"},"attack":[],"mbc":[{"parts":["Memory","Change Memory Protection"],"objective":"Memory","behavior":"Change Memory Protection","method":"","id":"C0008"}],"references":[],"examples":["Practical Malware Analysis Lab 11-02.dll_:0x10001203"],"description":"","lib":true,"is_subscope_rule":false,"maec":{}},"source":"rule:\r\n  meta:\r\n    name: change memory protection\r\n    authors:\r\n      - \"@mr-tz\"\r\n    lib: true\r\n    scopes:\r\n      static: basic block\r\n      dynamic: call\r\n    mbc:\r\n      - Memory::Change Memory Protection [C0008]\r\n    examples:\r\n      - Practical Malware Analysis Lab 11-02.dll_:0x10001203\r\n  features:\r\n    - or:\r\n      - api: kernel32.VirtualProtect\r\n      - api: kernel32.VirtualProtectEx\r\n      - api: NtProtectVirtualMemory\r\n      - api: ZwProtectVirtualMemory\r\n      - basic block:\r\n        - and:\r\n          - match: link function at runtime on Windows\r\n          - or:\r\n            - string: \"VirtualProtect\"\r\n            - string: \"VirtualProtectEx\"\r\n            - string: \"NtProtectVirtualMemory\"\r\n            - string: \"ZwProtectVirtualMemory\"\r\n","matches":[[{"type":"absolute","value":268460893},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"VirtualProtect"}},"children":[],"locations":[{"type":"absolute","value":268460913}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualProtectEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtProtectVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwProtectVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"change memory protection/25c211a8979840b9b5c90a4a295d45ff"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"send data on socket":{"meta":{"name":"send data on socket","namespace":"communication/socket/send","authors":["moritz.raabe@mandiant.com","joakim@intezer.com","anushka.virgaonkar@mandiant.com"],"scopes":{"static":"function","dynamic":"call"},"attack":[],"mbc":[{"parts":["Communication","Socket Communication","Send Data"],"objective":"Communication","behavior":"Socket Communication","method":"Send Data","id":"C0001.007"}],"references":[],"examples":["Practical Malware Analysis Lab 01-01.dll_:0x10001010"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\r\n  meta:\r\n    name: send data on socket\r\n    namespace: communication/socket/send\r\n    authors:\r\n      - moritz.raabe@mandiant.com\r\n      - joakim@intezer.com\r\n      - anushka.virgaonkar@mandiant.com\r\n    scopes:\r\n      static: function\r\n      dynamic: call\r\n    mbc:\r\n      - Communication::Socket Communication::Send Data [C0001.007]\r\n    examples:\r\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\r\n  features:\r\n    - or:\r\n      - api: send\r\n      - api: ws2_32.send\r\n      - api: ws2_32.#19 = send\r\n      - api: ws2_32.sendto\r\n      - api: ws2_32.#20 = sendto\r\n      - api: ws2_32.WSASend\r\n      - api: ws2_32.#76 = WSASend\r\n      - api: ws2_32.WSASendMsg\r\n      - api: ws2_32.WSASendTo\r\n      - api: ws2_32.#78 = WSASendTo\r\n      - api: System.Net.Sockets.Socket::Send\r\n      - api: System.Net.Sockets.Socket::SendAsync\r\n      - api: System.Net.Sockets.Socket::SendTo\r\n      - api: System.Net.Sockets.Socket::SendToAsync\r\n      - api: System.Net.Sockets.UdpClient::Send\r\n","matches":[[{"type":"absolute","value":268439808},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"send"}},"children":[],"locations":[{"type":"absolute","value":268439939}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#19","description":"send"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"sendto"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#20","description":"sendto"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WSASend"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#76","description":"WSASend"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WSASendMsg"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WSASendTo"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#78","description":"WSASendTo"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::Send"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::SendAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::SendTo"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::SendToAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.UdpClient::Send"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"send data":{"meta":{"name":"send data","namespace":"communication","authors":["william.ballenthin@mandiant.com","joakim@intezer.com"],"scopes":{"static":"function","dynamic":"span of calls"},"attack":[],"mbc":[{"parts":["Command and Control","C2 Communication","Send Data"],"objective":"Command and Control","behavior":"C2 Communication","method":"Send Data","id":"B0030.001"}],"references":[],"examples":["BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60"],"description":"all known techniques for sending data to a potential C2 server","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\r\n  meta:\r\n    name: send data\r\n    namespace: communication\r\n    authors:\r\n      - william.ballenthin@mandiant.com\r\n      - joakim@intezer.com\r\n    description: all known techniques for sending data to a potential C2 server\r\n    scopes:\r\n      static: function\r\n      dynamic: span of calls\r\n    mbc:\r\n      - Command and Control::C2 Communication::Send Data [B0030.001]\r\n    examples:\r\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60\r\n  features:\r\n    - or:\r\n      - and:\r\n        - os: windows\r\n        - or:\r\n          - match: send HTTP request\r\n          - match: send data on socket\r\n          - match: send file via HTTP\r\n          - match: send data to Internet\r\n      - and:\r\n        - os: linux\r\n        - or: # Require network bound socket.\r\n          - match: create TCP socket\r\n          - match: create UDP socket\r\n        - or:\r\n          - match: send HTTP request\r\n          - match: send data on socket\r\n          - match: send file via HTTP\r\n","matches":[[{"type":"absolute","value":268439808},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"send HTTP request"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"send data on socket"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"send"}},"children":[],"locations":[{"type":"absolute","value":268439939}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#19","description":"send"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"sendto"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#20","description":"sendto"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WSASend"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#76","description":"WSASend"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WSASendMsg"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WSASendTo"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#78","description":"WSASendTo"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::Send"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::SendAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::SendTo"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::SendToAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.UdpClient::Send"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":268439808}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"send file via HTTP"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"send data to Internet"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"linux"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"create TCP socket"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"create UDP socket"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"send HTTP request"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"send data on socket"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"send"}},"children":[],"locations":[{"type":"absolute","value":268439939}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#19","description":"send"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"sendto"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#20","description":"sendto"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WSASend"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#76","description":"WSASend"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WSASendMsg"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WSASendTo"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#78","description":"WSASendTo"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::Send"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::SendAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::SendTo"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::SendToAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.UdpClient::Send"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":268439808}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"send file via HTTP"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"connect TCP socket":{"meta":{"name":"connect TCP socket","namespace":"communication/socket/tcp","authors":["moritz.raabe@mandiant.com","joakim@intezer.com","mrhafizfarhad@gmail.com"],"scopes":{"static":"function","dynamic":"span of calls"},"attack":[],"mbc":[{"parts":["Communication","Socket Communication","Connect Socket"],"objective":"Communication","behavior":"Socket Communication","method":"Connect Socket","id":"C0001.004"}],"references":[],"examples":["Practical Malware Analysis Lab 01-01.dll_:0x10001010"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\r\n  meta:\r\n    name: connect TCP socket\r\n    namespace: communication/socket/tcp\r\n    authors:\r\n      - moritz.raabe@mandiant.com\r\n      - joakim@intezer.com\r\n      - mrhafizfarhad@gmail.com\r\n    scopes:\r\n      static: function\r\n      dynamic: span of calls\r\n    mbc:\r\n      - Communication::Socket Communication::Connect Socket [C0001.004]\r\n    examples:\r\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\r\n  features:\r\n    - and:\r\n      - match: create TCP socket\r\n      - match: connect socket\r\n","matches":[[{"type":"absolute","value":268440464},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"create TCP socket"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.Net.Sockets.TcpClient::Client"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":0,"description":"protocol (default)"}},"children":[],"locations":[{"type":"absolute","value":268440488}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":6,"description":"IPPROTO_TCP"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":1,"description":"SOCK_STREAM"}},"children":[],"locations":[{"type":"absolute","value":268440490}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":2,"description":"AF_INET"}},"children":[],"locations":[{"type":"absolute","value":268440492}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"socket"}},"children":[],"locations":[{"type":"absolute","value":268440494}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#23","description":"socket"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WSASocket"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#82","description":"WSASocketA"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#83","description":"WSASocketW"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::ctor"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":268440464}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"connect socket"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"connect"}},"children":[],"locations":[{"type":"absolute","value":268440594}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#4","description":"connect"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WSAConnect"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#33","description":"WSAConnect"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ConnectEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"connect socket/de796298ea8f4ca29b57757a42ca5d41"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"connect socket/1ed91bf416dc4f01908ac5f7906e2b00"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"connect socket/8395f4ba8695422cb384d376d8f23495"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"bind"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#2","description":"bind"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"connect socket/8361849cad2140ee91749b6b52c6d28b"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"connect socket/335655aa8c574140818096171ecc3606"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"bind"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#2","description":"bind"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":268440531}],"captures":{}}],"locations":[],"captures":{}}]]},"connect UDP socket":{"meta":{"name":"connect UDP socket","namespace":"communication/socket/udp","authors":["mrhafizfarhad@gmail.com"],"scopes":{"static":"function","dynamic":"span of calls"},"attack":[],"mbc":[{"parts":["Communication","Socket Communication","UDP Client"],"objective":"Communication","behavior":"Socket Communication","method":"UDP Client","id":"C0001.013"}],"references":[],"examples":["368239d36d221d8877a07ab6799e643a.elf_:0x20011E9"],"description":"Detects UDP socket connections by combining UDP socket creation with connection attempts.","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\r\n  meta:\r\n    name: connect UDP socket\r\n    namespace: communication/socket/udp\r\n    authors:\r\n      - mrhafizfarhad@gmail.com\r\n    description: Detects UDP socket connections by combining UDP socket creation with connection attempts.\r\n    scopes:\r\n      static: function\r\n      dynamic: span of calls\r\n    mbc:\r\n      - Communication::Socket Communication::UDP Client [C0001.013]\r\n    examples:\r\n      - 368239d36d221d8877a07ab6799e643a.elf_:0x20011E9\r\n  features:\r\n    - and:\r\n      - match: create UDP socket\r\n      - match: connect socket\r\n","matches":[[{"type":"absolute","value":268440464},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"create UDP socket"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.UdpClient::ctor"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":2,"description":"AF_INET"}},"children":[],"locations":[{"type":"absolute","value":268440492}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":0,"description":"protocol (default)"}},"children":[],"locations":[{"type":"absolute","value":268440488}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":17,"description":"IPPROTO_UDP"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"socket"}},"children":[],"locations":[{"type":"absolute","value":268440494}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#23","description":"socket"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WSASocket"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#82","description":"WSASocketA"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#83","description":"WSASocketW"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::ctor"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":268440464}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"connect socket"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"connect"}},"children":[],"locations":[{"type":"absolute","value":268440594}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#4","description":"connect"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WSAConnect"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#33","description":"WSAConnect"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ConnectEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"connect socket/de796298ea8f4ca29b57757a42ca5d41"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"connect socket/1ed91bf416dc4f01908ac5f7906e2b00"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"connect socket/8395f4ba8695422cb384d376d8f23495"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"bind"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#2","description":"bind"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"connect socket/8361849cad2140ee91749b6b52c6d28b"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"connect socket/335655aa8c574140818096171ecc3606"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"bind"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#2","description":"bind"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":268440531}],"captures":{}}],"locations":[],"captures":{}}]]},"act as TCP client":{"meta":{"name":"act as TCP client","namespace":"communication/tcp/client","authors":["william.ballenthin@mandiant.com","michael.hunhoff@mandiant.com"],"scopes":{"static":"function","dynamic":"span of calls"},"attack":[],"mbc":[{"parts":["Communication","Socket Communication","TCP Client"],"objective":"Communication","behavior":"Socket Communication","method":"TCP Client","id":"C0001.008"}],"references":[],"examples":["Practical Malware Analysis Lab 01-01.dll_:0x10001010"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\r\n  meta:\r\n    name: act as TCP client\r\n    namespace: communication/tcp/client\r\n    authors:\r\n      - william.ballenthin@mandiant.com\r\n      - michael.hunhoff@mandiant.com\r\n    scopes:\r\n      static: function\r\n      dynamic: span of calls\r\n    mbc:\r\n      - Communication::Socket Communication::TCP Client [C0001.008]\r\n    examples:\r\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\r\n  features:\r\n    - or:\r\n      - match: connect TCP socket\r\n      - api: System.Net.Sockets.TcpClient::ctor\r\n","matches":[[{"type":"absolute","value":268440464},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"connect TCP socket"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"create TCP socket"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.Net.Sockets.TcpClient::Client"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":0,"description":"protocol (default)"}},"children":[],"locations":[{"type":"absolute","value":268440488}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":6,"description":"IPPROTO_TCP"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":1,"description":"SOCK_STREAM"}},"children":[],"locations":[{"type":"absolute","value":268440490}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":2,"description":"AF_INET"}},"children":[],"locations":[{"type":"absolute","value":268440492}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"socket"}},"children":[],"locations":[{"type":"absolute","value":268440494}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#23","description":"socket"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WSASocket"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#82","description":"WSASocketA"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#83","description":"WSASocketW"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::ctor"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":268440464}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"connect socket"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"connect"}},"children":[],"locations":[{"type":"absolute","value":268440594}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#4","description":"connect"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WSAConnect"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#33","description":"WSAConnect"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ConnectEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"connect socket/de796298ea8f4ca29b57757a42ca5d41"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"connect socket/1ed91bf416dc4f01908ac5f7906e2b00"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"connect socket/8395f4ba8695422cb384d376d8f23495"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"bind"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#2","description":"bind"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"connect socket/8361849cad2140ee91749b6b52c6d28b"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"connect socket/335655aa8c574140818096171ecc3606"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"bind"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#2","description":"bind"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":268440531}],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":268440464}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.TcpClient::ctor"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"contain loop":{"meta":{"name":"contain loop","authors":["moritz.raabe@mandiant.com"],"scopes":{"static":"function"},"attack":[],"mbc":[],"references":[],"examples":["08AC667C65D36D6542917655571E61C8:0x406EAA"],"description":"","lib":true,"is_subscope_rule":false,"maec":{}},"source":"rule:\r\n  meta:\r\n    name: contain loop\r\n    authors:\r\n      - moritz.raabe@mandiant.com\r\n    lib: true\r\n    scopes:\r\n      static: function\r\n      dynamic: unsupported  # requires characteristic features\r\n    examples:\r\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\r\n  features:\r\n    - or:\r\n      - characteristic: loop\r\n      - characteristic: tight loop\r\n      - characteristic: recursive call\r\n","matches":[[{"type":"absolute","value":268440688},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":268440688}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268441424},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":268441424}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":268441530},{"type":"absolute","value":268441775}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268441892},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":268441892}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268441936},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":268441936}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268444864},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":268444890}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268445032},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":268445076}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268445586},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":268445586}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268446604},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":268446604}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":268446728},{"type":"absolute","value":268446653}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268447601},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":268447601}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":268447822}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268448471},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":268448471}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268448966},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":268448966}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268449067},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":268449067}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268450064},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":268450064}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268450251},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":268450251}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268450761},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":268450761}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268450837},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":268450837}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268451036},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":268451036}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268451852},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":268451852}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268451901},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":268451901}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268451920},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":268451920}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268451969},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":268451969}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268451988},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":268451988}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268455020},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":268455020}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":268455073}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268455422},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":268455422}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":268455628},{"type":"absolute","value":268455734}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268455828},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":268455828}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268456208},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":268456283},{"type":"absolute","value":268456243}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268456320},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":268456320}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":268456352}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268457382},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":268457382}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268459264},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":268459264}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268460640},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":268460640}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268460718},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":268460718}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268460927},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":268460927}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268461792},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":268461792}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"receive data on socket":{"meta":{"name":"receive data on socket","namespace":"communication/socket/receive","authors":["moritz.raabe@mandiant.com","joakim@intezer.com","michael.hunhoff@mandiant.com"],"scopes":{"static":"function","dynamic":"call"},"attack":[],"mbc":[{"parts":["Communication","Socket Communication","Receive Data"],"objective":"Communication","behavior":"Socket Communication","method":"Receive Data","id":"C0001.006"}],"references":[],"examples":["Practical Malware Analysis Lab 01-01.dll_:0x10001010"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\r\n  meta:\r\n    name: receive data on socket\r\n    namespace: communication/socket/receive\r\n    authors:\r\n      - moritz.raabe@mandiant.com\r\n      - joakim@intezer.com\r\n      - michael.hunhoff@mandiant.com\r\n    scopes:\r\n      static: function\r\n      dynamic: call\r\n    mbc:\r\n      - Communication::Socket Communication::Receive Data [C0001.006]\r\n    examples:\r\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\r\n  features:\r\n    - or:\r\n      - api: recv\r\n      - api: ws2_32.recv\r\n      - api: ws2_32.#16 = recv\r\n      - api: ws2_32.recvfrom\r\n      - api: ws2_32.#17 = recvfrom\r\n      - api: ws2_32.WSARecv\r\n      - api: ws2_32.#71 = WSARecv\r\n      - api: ws2_32.WSARecvDisconnect\r\n      - api: ws2_32.#72 = WSARecvDisconnect\r\n      - api: ws2_32.WSARecvEx\r\n      - api: ws2_32.WSARecvFrom\r\n      - api: ws2_32.#73 = WSARecvFrom\r\n      - api: ws2_32.WSARecvMsg\r\n      - api: recvmsg\r\n      - api: System.Net.Sockets.Socket::Receive\r\n      - api: System.Net.Sockets.Socket::ReceiveAsync\r\n      - api: System.Net.Sockets.Socket::ReceiveFrom\r\n      - api: System.Net.Sockets.Socket::ReceiveFromAsync\r\n      - api: System.Net.Sockets.Socket::ReceiveMessageFrom\r\n      - api: System.Net.Sockets.Socket::ReceiveMessageFromAsync\r\n      - api: System.Net.Sockets.Socket::BeginReceive\r\n      - api: System.Net.Sockets.Socket::BeginReceiveFrom\r\n      - api: System.Net.Sockets.Socket::BeginReceiveMessageFrom\r\n      - api: System.Net.Sockets.Socket::EndReceive\r\n      - api: System.Net.Sockets.Socket::EndReceiveFrom\r\n      - api: System.Net.Sockets.Socket::EndReceiveMessageFrom\r\n","matches":[[{"type":"absolute","value":268440688},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"recv"}},"children":[],"locations":[{"type":"absolute","value":268440755}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#16","description":"recv"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"recvfrom"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#17","description":"recvfrom"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WSARecv"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#71","description":"WSARecv"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WSARecvDisconnect"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#72","description":"WSARecvDisconnect"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WSARecvEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WSARecvFrom"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#73","description":"WSARecvFrom"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WSARecvMsg"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"recvmsg"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::Receive"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::ReceiveAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::ReceiveFrom"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::ReceiveFromAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::ReceiveMessageFrom"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::ReceiveMessageFromAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::BeginReceive"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::BeginReceiveFrom"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::BeginReceiveMessageFrom"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::EndReceive"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::EndReceiveFrom"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::EndReceiveMessageFrom"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"receive data":{"meta":{"name":"receive data","namespace":"communication","authors":["william.ballenthin@mandiant.com"],"scopes":{"static":"function","dynamic":"span of calls"},"attack":[],"mbc":[{"parts":["Command and Control","C2 Communication","Receive Data"],"objective":"Command and Control","behavior":"C2 Communication","method":"Receive Data","id":"B0030.002"}],"references":[],"examples":["BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60"],"description":"all known techniques for receiving data from a potential C2 server","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\r\n  meta:\r\n    name: receive data\r\n    namespace: communication\r\n    authors:\r\n      - william.ballenthin@mandiant.com\r\n    description: all known techniques for receiving data from a potential C2 server\r\n    scopes:\r\n      static: function\r\n      dynamic: span of calls\r\n    mbc:\r\n      - Command and Control::C2 Communication::Receive Data [B0030.002]\r\n    examples:\r\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145D60\r\n  features:\r\n    - or:\r\n      - match: receive data on socket\r\n      - match: read data from Internet\r\n      - match: download URL\r\n","matches":[[{"type":"absolute","value":268440688},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"receive data on socket"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"recv"}},"children":[],"locations":[{"type":"absolute","value":268440755}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#16","description":"recv"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"recvfrom"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#17","description":"recvfrom"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WSARecv"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#71","description":"WSARecv"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WSARecvDisconnect"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#72","description":"WSARecvDisconnect"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WSARecvEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WSARecvFrom"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#73","description":"WSARecvFrom"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WSARecvMsg"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"recvmsg"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::Receive"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::ReceiveAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::ReceiveFrom"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::ReceiveFromAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::ReceiveMessageFrom"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::ReceiveMessageFromAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::BeginReceive"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::BeginReceiveFrom"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::BeginReceiveMessageFrom"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::EndReceive"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::EndReceiveFrom"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Net.Sockets.Socket::EndReceiveMessageFrom"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":268440688}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"read data from Internet"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"download URL"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"initialize Winsock library":{"meta":{"name":"initialize Winsock library","namespace":"communication/socket","authors":["michael.hunhoff@mandiant.com"],"scopes":{"static":"function","dynamic":"call"},"attack":[],"mbc":[{"parts":["Communication","Socket Communication","Initialize Winsock Library"],"objective":"Communication","behavior":"Socket Communication","method":"Initialize Winsock Library","id":"C0001.009"}],"references":[],"examples":["6A352C3E55E8AE5ED39DC1BE7FB964B1:0x10001D30"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\r\n  meta:\r\n    name: initialize Winsock library\r\n    namespace: communication/socket\r\n    authors:\r\n      - michael.hunhoff@mandiant.com\r\n    scopes:\r\n      static: function\r\n      dynamic: call\r\n    mbc:\r\n      - Communication::Socket Communication::Initialize Winsock Library [C0001.009]\r\n    examples:\r\n      - 6A352C3E55E8AE5ED39DC1BE7FB964B1:0x10001D30\r\n  features:\r\n    - or:\r\n      - api: ws2_32.WSAStartup\r\n      - api: ws2_32.#115 = WSAStartup\r\n","matches":[[{"type":"absolute","value":268441184},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"WSAStartup"}},"children":[],"locations":[{"type":"absolute","value":268441213}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ws2_32.#115","description":"WSAStartup"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"encrypt data using RC6":{"meta":{"name":"encrypt data using RC6","namespace":"data-manipulation/encryption/rc6","authors":["william.ballenthin@mandiant.com"],"scopes":{"static":"function","dynamic":"span of calls"},"attack":[{"parts":["Defense Evasion","Obfuscated Files or Information"],"tactic":"Defense Evasion","technique":"Obfuscated Files or Information","subtechnique":"","id":"T1027"}],"mbc":[{"parts":["Defense Evasion","Obfuscated Files or Information","Encryption-Standard Algorithm"],"objective":"Defense Evasion","behavior":"Obfuscated Files or Information","method":"Encryption-Standard Algorithm","id":"E1027.m05"},{"parts":["Cryptography","Encrypt Data","RC6"],"objective":"Cryptography","behavior":"Encrypt Data","method":"RC6","id":"C0027.010"}],"references":["https://github.com/stamparm/cryptospecs/blob/master/symmetrical/sources/rc6.c#L66"],"examples":["D87BA0BFCE1CDB17FD243B8B1D247E88:0x402390"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\r\n  meta:\r\n    name: encrypt data using RC6\r\n    namespace: data-manipulation/encryption/rc6\r\n    authors:\r\n      - william.ballenthin@mandiant.com\r\n    scopes:\r\n      static: function\r\n      dynamic: span of calls\r\n    att&ck:\r\n      - Defense Evasion::Obfuscated Files or Information [T1027]\r\n    mbc:\r\n      - Defense Evasion::Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]\r\n      - Cryptography::Encrypt Data::RC6 [C0027.010]\r\n    references:\r\n      - https://github.com/stamparm/cryptospecs/blob/master/symmetrical/sources/rc6.c#L66\r\n    examples:\r\n      - D87BA0BFCE1CDB17FD243B8B1D247E88:0x402390\r\n  features:\r\n    - and:\r\n      - or:\r\n        - description: P, used by both RC5 and RC6 (more common)\r\n        - number: 0xB7E15163 = P (32-bit)\r\n        - number: 0xB7E151628AED2A6B = P (64-bit)\r\n      - or:\r\n        - description: Q, used by both RC5 and RC6 (more common)\r\n        - or:\r\n          - number: 0x9e3779b9 = Q (32-bit), encrypt via add an unsigned\r\n          - number: 0x61C88647 = Q (32-bit), encrypt via subtract an unsigned\r\n        - number: 0x9E3779B97F4A7C15 = Q (64-bit)\r\n","matches":[[{"type":"absolute","value":268441424},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or","description":"P, used by both RC5 and RC6 (more common)"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":3084996963,"description":"P (32-bit)"}},"children":[],"locations":[{"type":"absolute","value":268441742}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":13249961062380153451,"description":"P (64-bit)"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or","description":"Q, used by both RC5 and RC6 (more common)"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2654435769,"description":"Q (32-bit), encrypt via add an unsigned"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":1640531527,"description":"Q (32-bit), encrypt via subtract an unsigned"}},"children":[],"locations":[{"type":"absolute","value":268441779}],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":11400714819323198485,"description":"Q (64-bit)"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"get OS version":{"meta":{"name":"get OS version","authors":["@mr-tz"],"scopes":{"static":"function","dynamic":"call"},"attack":[],"mbc":[],"references":[],"examples":["493167E85E45363D09495D0841C30648:0x401000","5f66b82558ca92e54e77f216ef4c066c:0x44580A"],"description":"","lib":true,"is_subscope_rule":false,"maec":{}},"source":"rule:\r\n  meta:\r\n    name: get OS version\r\n    authors:\r\n      - \"@mr-tz\"\r\n    lib: true\r\n    scopes:\r\n      static: function\r\n      dynamic: call\r\n    examples:\r\n      - 493167E85E45363D09495D0841C30648:0x401000\r\n      - 5f66b82558ca92e54e77f216ef4c066c:0x44580A\r\n  features:\r\n    - or:\r\n      - api: RtlGetVersion\r\n      - api: ntoskrnl.PsGetVersion\r\n      - api: GetVersion\r\n      - api: GetVersionEx\r\n      - api: VerifyVersionInfo\r\n      - api: VerSetConditionMask\r\n      - api: RtlGetNtVersionNumbers\r\n      - api: GetProductInfo\r\n      - and:\r\n        - match: PEB access\r\n        - or:\r\n          - and:\r\n            - arch: i386\r\n            - or:\r\n              - offset: 0xA4 = PEB->OSMajorVersion\r\n              - offset: 0xA8 = PEB->OSMinorVersion\r\n              - offset: 0xAC = PEB->OSBuildNumber\r\n          - and:\r\n            - arch: amd64\r\n            - or:\r\n              - offset: 0x118 = PEB->OSMajorVersion\r\n              - offset: 0x11C = PEB->OSMinorVersion\r\n              - offset: 0x120 = PEB->OSBuildNumber\r\n","matches":[[{"type":"absolute","value":268444269},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlGetVersion"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"PsGetVersion"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetVersion"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetVersionEx"}},"children":[],"locations":[{"type":"absolute","value":268444304}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VerifyVersionInfo"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VerSetConditionMask"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlGetNtVersionNumbers"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetProductInfo"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"PEB access"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"offset","offset":164,"description":"PEB->OSMajorVersion"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"offset","offset":168,"description":"PEB->OSMinorVersion"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"offset","offset":172,"description":"PEB->OSBuildNumber"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"offset","offset":280,"description":"PEB->OSMajorVersion"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"offset","offset":284,"description":"PEB->OSMinorVersion"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"offset","offset":288,"description":"PEB->OSBuildNumber"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"set thread local storage value":{"meta":{"name":"set thread local storage value","namespace":"host-interaction/thread/tls","authors":["michael.hunhoff@mandiant.com"],"scopes":{"static":"function","dynamic":"span of calls"},"attack":[],"mbc":[{"parts":["Process","Set Thread Local Storage Value"],"objective":"Process","behavior":"Set Thread Local Storage Value","method":"","id":"C0041"}],"references":[],"examples":["03B236B23B1EC37C663527C1F53AF3FE:0x18000AE21"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\r\n  meta:\r\n    name: set thread local storage value\r\n    namespace: host-interaction/thread/tls\r\n    authors:\r\n      - michael.hunhoff@mandiant.com\r\n    scopes:\r\n      static: function\r\n      dynamic: span of calls\r\n    mbc:\r\n      - Process::Set Thread Local Storage Value [C0041]\r\n    examples:\r\n      - 03B236B23B1EC37C663527C1F53AF3FE:0x18000AE21\r\n  features:\r\n    - and:\r\n      - api: kernel32.TlsSetValue\r\n      - optional:\r\n        - match: allocate thread local storage\r\n","matches":[[{"type":"absolute","value":268444269},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"TlsSetValue"}},"children":[],"locations":[{"type":"absolute","value":268444586}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate thread local storage"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268449477},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"TlsSetValue"}},"children":[],"locations":[{"type":"absolute","value":268449532}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate thread local storage"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268449590},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"TlsSetValue"}},"children":[],"locations":[{"type":"absolute","value":268449917}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate thread local storage"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268449953},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"TlsSetValue"}},"children":[],"locations":[{"type":"absolute","value":268450014}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"allocate thread local storage"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"TlsAlloc"}},"children":[],"locations":[{"type":"absolute","value":268449962}],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":268449953}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"accept command line arguments":{"meta":{"name":"accept command line arguments","namespace":"host-interaction/cli","authors":["moritz.raabe@mandiant.com","anushka.virgaonkar@mandiant.com"],"scopes":{"static":"function","dynamic":"call"},"attack":[{"parts":["Execution","Command and Scripting Interpreter"],"tactic":"Execution","technique":"Command and Scripting Interpreter","subtechnique":"","id":"T1059"}],"mbc":[{"parts":["Execution","Command and Scripting Interpreter"],"objective":"Execution","behavior":"Command and Scripting Interpreter","method":"","id":"E1059"}],"references":[],"examples":["e5369ac309f1be6d77afeeb3edab0ed8:0x402760"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\r\n  meta:\r\n    name: accept command line arguments\r\n    namespace: host-interaction/cli\r\n    authors:\r\n      - moritz.raabe@mandiant.com\r\n      - anushka.virgaonkar@mandiant.com\r\n    scopes:\r\n      static: function\r\n      dynamic: call\r\n    att&ck:\r\n      - Execution::Command and Scripting Interpreter [T1059]\r\n    mbc:\r\n      - Execution::Command and Scripting Interpreter [E1059]\r\n    examples:\r\n      - e5369ac309f1be6d77afeeb3edab0ed8:0x402760\r\n  features:\r\n    - or:\r\n      - api: GetCommandLine\r\n      - api: CommandLineToArgv\r\n      - api: System.Environment::GetCommandLineArgs\r\n","matches":[[{"type":"absolute","value":268444269},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetCommandLine"}},"children":[],"locations":[{"type":"absolute","value":268444426}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CommandLineToArgv"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Environment::GetCommandLineArgs"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"terminate process":{"meta":{"name":"terminate process","namespace":"host-interaction/process/terminate","authors":["moritz.raabe@mandiant.com","michael.hunhoff@mandiant.com","anushka.virgaonkar@mandiant.com"],"scopes":{"static":"function","dynamic":"span of calls"},"attack":[],"mbc":[{"parts":["Process","Terminate Process"],"objective":"Process","behavior":"Terminate Process","method":"","id":"C0018"}],"references":[],"examples":["C91887D861D9BD4A5872249B641BC9F9:0x401A77","9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\r\n  meta:\r\n    name: terminate process\r\n    namespace: host-interaction/process/terminate\r\n    authors:\r\n      - moritz.raabe@mandiant.com\r\n      - michael.hunhoff@mandiant.com\r\n      - anushka.virgaonkar@mandiant.com\r\n    scopes:\r\n      static: function\r\n      dynamic: span of calls\r\n    mbc:\r\n      - Process::Terminate Process [C0018]\r\n    examples:\r\n      - C91887D861D9BD4A5872249B641BC9F9:0x401A77\r\n      - 9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307\r\n  features:\r\n    - or:\r\n      - api: System.Diagnostics.Process::Kill\r\n      - api: System.Diagnostics.Process::WaitForExit\r\n      - api: System.Diagnostics.Process::WaitForExitAsync\r\n      - api: System.Environment::Exit\r\n      - api: System.Windows.Forms.Application::Exit\r\n      - api: exit\r\n      - api: Exit\r\n      - and:\r\n        - os: linux\r\n        - api: exit_group\r\n      - and:\r\n        - optional:\r\n          - match: open process\r\n        - or:\r\n          - api: kernel32.TerminateProcess\r\n          - api: ntdll.NtTerminateProcess\r\n          - api: kernel32.ExitProcess\r\n","matches":[[{"type":"absolute","value":268448900},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Diagnostics.Process::Kill"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Diagnostics.Process::WaitForExit"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Diagnostics.Process::WaitForExitAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Environment::Exit"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Windows.Forms.Application::Exit"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"exit"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Exit"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"linux"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"exit_group"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"open process"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"TerminateProcess"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtTerminateProcess"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"ExitProcess"}},"children":[],"locations":[{"type":"absolute","value":268448941}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268449067},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Diagnostics.Process::Kill"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Diagnostics.Process::WaitForExit"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Diagnostics.Process::WaitForExitAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Environment::Exit"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Windows.Forms.Application::Exit"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"exit"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Exit"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"linux"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"exit_group"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"open process"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"TerminateProcess"}},"children":[],"locations":[{"type":"absolute","value":268449101}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtTerminateProcess"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ExitProcess"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"get thread local storage value":{"meta":{"name":"get thread local storage value","namespace":"host-interaction/process","authors":["michael.hunhoff@mandiant.com"],"scopes":{"static":"function","dynamic":"call"},"attack":[],"mbc":[],"references":[],"examples":[],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\r\n  meta:\r\n    name: get thread local storage value\r\n    namespace: host-interaction/process\r\n    authors:\r\n      - michael.hunhoff@mandiant.com\r\n    scopes:\r\n      static: function\r\n      dynamic: call\r\n  features:\r\n    - and:\r\n      - api: kernel32.TlsGetValue\r\n","matches":[[{"type":"absolute","value":268449477},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"TlsGetValue"}},"children":[],"locations":[{"type":"absolute","value":268449493}],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":268449590},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"TlsGetValue"}},"children":[],"locations":[{"type":"absolute","value":268449624}],"captures":{}}],"locations":[],"captures":{}}]]},"allocate thread local storage":{"meta":{"name":"allocate thread local storage","namespace":"host-interaction/thread/tls","authors":["michael.hunhoff@mandiant.com"],"scopes":{"static":"function","dynamic":"call"},"attack":[],"mbc":[{"parts":["Process","Allocate Thread Local Storage"],"objective":"Process","behavior":"Allocate Thread Local Storage","method":"","id":"C0040"}],"references":[],"examples":["03B236B23B1EC37C663527C1F53AF3FE:0x18000ADF6"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\r\n  meta:\r\n    name: allocate thread local storage\r\n    namespace: host-interaction/thread/tls\r\n    authors:\r\n      - michael.hunhoff@mandiant.com\r\n    scopes:\r\n      static: function\r\n      dynamic: call\r\n    mbc:\r\n      - Process::Allocate Thread Local Storage [C0040]\r\n    examples:\r\n      - 03B236B23B1EC37C663527C1F53AF3FE:0x18000ADF6\r\n  features:\r\n    - or:\r\n      - api: kernel32.TlsAlloc\r\n","matches":[[{"type":"absolute","value":268449953},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"TlsAlloc"}},"children":[],"locations":[{"type":"absolute","value":268449962}],"captures":{}}],"locations":[],"captures":{}}]]},"write file on Windows":{"meta":{"name":"write file on Windows","namespace":"host-interaction/file-system/write","authors":["william.ballenthin@mandiant.com","anushka.virgaonkar@mandiant.com"],"scopes":{"static":"function","dynamic":"call"},"attack":[],"mbc":[{"parts":["File System","Writes File"],"objective":"File System","behavior":"Writes File","method":"","id":"C0052"}],"references":[],"examples":["Practical Malware Analysis Lab 01-04.exe_:0x4011FC","563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x1400025C4"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\r\n  meta:\r\n    name: write file on Windows\r\n    namespace: host-interaction/file-system/write\r\n    authors:\r\n      - william.ballenthin@mandiant.com\r\n      - anushka.virgaonkar@mandiant.com\r\n    scopes:\r\n      static: function\r\n      dynamic: call\r\n    mbc:\r\n      - File System::Writes File [C0052]\r\n    examples:\r\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\r\n      # ntdll\r\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x1400025C4\r\n  features:\r\n    - or:\r\n      - and:\r\n        - os: windows\r\n        - optional:\r\n          - basic block:\r\n            - or:\r\n              - number: 0x40000000 = GENERIC_WRITE\r\n              - number: 0x2 = FILE_WRITE_DATA\r\n              - match: create or open file\r\n          - call:\r\n            - or:\r\n              - number: 0x40000000 = GENERIC_WRITE\r\n              - number: 0x2 = FILE_WRITE_DATA\r\n              - match: create or open file\r\n        - or:\r\n          - api: kernel32.WriteFile\r\n          - api: kernel32.WriteFileEx\r\n          - api: NtWriteFile\r\n          - api: ZwWriteFile\r\n          - api: _fwrite\r\n          - api: fwrite\r\n      - api: System.IO.File::WriteAllBytes\r\n      - api: System.IO.File::WriteAllBytesAsync\r\n      - api: System.IO.File::WriteAllLines\r\n      - api: System.IO.File::WriteAllLinesAsync\r\n      - api: System.IO.File::WriteAllText\r\n      - api: System.IO.File::WriteAllTextAsync\r\n      - api: System.IO.File::AppendAllLines\r\n      - api: System.IO.File::AppendAllLinesAsync\r\n      - api: System.IO.File::AppendAllText\r\n      - api: System.IO.File::AppendAllTextAsync\r\n      - api: System.IO.File::AppendText\r\n      - api: System.IO.FileInfo::AppendText\r\n","matches":[[{"type":"absolute","value":268451988},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::WriteAllBytes"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::WriteAllBytesAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::WriteAllLines"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::WriteAllLinesAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::WriteAllText"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::WriteAllTextAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::AppendAllLines"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::AppendAllLinesAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::AppendAllText"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::AppendAllTextAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::AppendText"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.FileInfo::AppendText"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"write file on Windows/8c961232a5c44a7fa0a6a7421e1864e6"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"write file on Windows/38a6be563e9a45669b4c21957bc154d9"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"WriteFile"}},"children":[],"locations":[{"type":"absolute","value":268452335}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WriteFileEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtWriteFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwWriteFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"_fwrite"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fwrite"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"link many functions at runtime":{"meta":{"name":"link many functions at runtime","namespace":"linking/runtime-linking","authors":["moritz.raabe@mandiant.com","joakim@intezer.com"],"scopes":{"static":"function","dynamic":"span of calls"},"attack":[{"parts":["Execution","Shared Modules"],"tactic":"Execution","technique":"Shared Modules","subtechnique":"","id":"T1129"}],"mbc":[],"references":[],"examples":["b7b5e1253710d8927cbe07d52d2d2e10:0x401000"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\r\n  meta:\r\n    name: link many functions at runtime\r\n    namespace: linking/runtime-linking\r\n    authors:\r\n      - moritz.raabe@mandiant.com\r\n      - joakim@intezer.com\r\n    scopes:\r\n      static: function\r\n      dynamic: span of calls\r\n    att&ck:\r\n      - Execution::Shared Modules [T1129]\r\n    examples:\r\n      - b7b5e1253710d8927cbe07d52d2d2e10:0x401000\r\n  features:\r\n    - or:\r\n      - count(match(link function at runtime on Windows)): 5 or more\r\n      - count(match(link function at runtime on Linux)): 5 or more\r\n","matches":[[{"type":"absolute","value":268456699},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"range","min":5,"max":9223372036854775808,"child":{"type":"match","match":"link function at runtime on Windows"}}},"children":[],"locations":[{"type":"absolute","value":268456768},{"type":"absolute","value":268456803},{"type":"absolute","value":268456820},{"type":"absolute","value":268456781},{"type":"absolute","value":268456751}],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"range","min":5,"max":9223372036854775808,"child":{"type":"match","match":"link function at runtime on Linux"}}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"get system information on Windows":{"meta":{"name":"get system information on Windows","namespace":"host-interaction/os/info","authors":["moritz.raabe@mandiant.com","joakim@intezer.com"],"scopes":{"static":"function","dynamic":"span of calls"},"attack":[{"parts":["Discovery","System Information Discovery"],"tactic":"Discovery","technique":"System Information Discovery","subtechnique":"","id":"T1082"}],"mbc":[],"references":[],"examples":["563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140002280"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\r\n  meta:\r\n    name: get system information on Windows\r\n    namespace: host-interaction/os/info\r\n    authors:\r\n      - moritz.raabe@mandiant.com\r\n      - joakim@intezer.com\r\n    scopes:\r\n      static: function\r\n      dynamic: span of calls\r\n    att&ck:\r\n      - Discovery::System Information Discovery [T1082]\r\n    examples:\r\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140002280\r\n  features:\r\n    - and:\r\n      - os: windows\r\n      - or:\r\n        - api: kernel32.GetSystemInfo\r\n        - api: kernel32.GetNativeSystemInfo\r\n        - api: NtQuerySystemInformation\r\n        - api: NtQuerySystemInformationEx\r\n        - api: ntdll.RtlGetNativeSystemInformation\r\n        - api: ZwQuerySystemInformation\r\n        - api: ZwQuerySystemInformationEx\r\n","matches":[[{"type":"absolute","value":268460718},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetSystemInfo"}},"children":[],"locations":[{"type":"absolute","value":268460761}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetNativeSystemInfo"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtQuerySystemInformation"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtQuerySystemInformationEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlGetNativeSystemInformation"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwQuerySystemInformation"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwQuerySystemInformationEx"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"get geographical location":{"meta":{"name":"get geographical location","namespace":"collection","authors":["moritz.raabe","michael.hunhoff@mandiant.com"],"scopes":{"static":"function","dynamic":"call"},"attack":[{"parts":["Discovery","System Location Discovery"],"tactic":"Discovery","technique":"System Location Discovery","subtechnique":"","id":"T1614"}],"mbc":[],"references":[],"examples":["9879D201DC5ACA863F357184CD1F170E:0x10001A99"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"# generated using capa explorer for IDA Pro\r\nrule:\r\n  meta:\r\n    name: get geographical location\r\n    namespace: collection\r\n    authors:\r\n      - moritz.raabe\r\n      - michael.hunhoff@mandiant.com\r\n    scopes:\r\n      static: function\r\n      dynamic: call\r\n    att&ck:\r\n      - Discovery::System Location Discovery [T1614]\r\n    examples:\r\n      - 9879D201DC5ACA863F357184CD1F170E:0x10001A99\r\n  features:\r\n    - or:\r\n      - api: GetLocaleInfo\r\n      - api: GetLocaleInfoEx\r\n      - api: kernel32.GetUserGeoID\r\n      - api: kernel32.GetGeoInfo\r\n      # strings part of requests or parsed from response\r\n      # \"geo\" and \"zip\" are too short\r\n      # \"region\" results in FPs mostly related to memory\r\n      - string: /geolocation/i\r\n      - string: /geo-location/i\r\n      - string: /^city/i\r\n      - string: /region_code/i\r\n      - string: /region_name/i\r\n      - string: /^country/i\r\n      - string: /country_code/i\r\n      - string: /countrycode/i\r\n      - string: /country_name/i\r\n      - string: /continent_code/i\r\n      - string: /continent_name/i\r\n      - string: /^latitude/i\r\n      - string: /^longitude/i\r\n","matches":[[{"type":"absolute","value":268461063},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetLocaleInfo"}},"children":[],"locations":[{"type":"absolute","value":268461098}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetLocaleInfoEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetUserGeoID"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetGeoInfo"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/geolocation/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/geo-location/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/^city/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/region_code/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/region_name/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/^country/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/country_code/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/countrycode/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/country_name/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/continent_code/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/continent_name/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/^latitude/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/^longitude/i"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]}}}
