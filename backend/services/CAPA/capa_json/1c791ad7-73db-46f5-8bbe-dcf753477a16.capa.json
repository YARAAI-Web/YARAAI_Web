{"meta":{"timestamp":"2025-07-06T17:25:46.299931","version":"9.2.1","argv":["-r","D:\\Whitehat\\web\\YARRAI_Web\\backend\\services\\CAPA\\capa-rules","-s","D:\\Whitehat\\web\\YARRAI_Web\\backend\\services\\CAPA\\capa-sigs","--json","D:\\Whitehat\\web\\외부 api\\uploads\\1c791ad7-73db-46f5-8bbe-dcf753477a16.exe"],"sample":{"md5":"845e7763ffb4246b3f294b418b0d9b9c","sha1":"93b859cc45aacca9277b7d42b2254a2bdeb76465","sha256":"0d4e423cb2ba20b3e48bb4b1a93cce4e7e49cb955b6dae20a06b64363d54fb3c","path":"D:/Whitehat/web/외부 api/uploads/1c791ad7-73db-46f5-8bbe-dcf753477a16.exe"},"flavor":"static","analysis":{"format":"pe","arch":"amd64","os":"windows","extractor":"VivisectFeatureExtractor","rules":["D:/Whitehat/web/YARRAI_Web/backend/services/CAPA/capa-rules"],"base_address":{"type":"absolute","value":5368709120},"layout":{"functions":[{"address":{"type":"absolute","value":5368713216},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368713216}},{"address":{"type":"absolute","value":5368721368}}]},{"address":{"type":"absolute","value":5368713276},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368713276}},{"address":{"type":"absolute","value":5368721368}}]},{"address":{"type":"absolute","value":5368713360},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368713396}},{"address":{"type":"absolute","value":5368713426}}]},{"address":{"type":"absolute","value":5368713440},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368713440}},{"address":{"type":"absolute","value":5368713712}}]},{"address":{"type":"absolute","value":5368713808},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368713808}}]},{"address":{"type":"absolute","value":5368713888},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368713888}}]},{"address":{"type":"absolute","value":5368714096},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368714141}},{"address":{"type":"absolute","value":5368714171}}]},{"address":{"type":"absolute","value":5368714192},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368714227}},{"address":{"type":"absolute","value":5368714257}}]},{"address":{"type":"absolute","value":5368714272},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368714272}}]},{"address":{"type":"absolute","value":5368714368},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368714368}}]},{"address":{"type":"absolute","value":5368714464},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368714464}},{"address":{"type":"absolute","value":5368714517}}]},{"address":{"type":"absolute","value":5368714656},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368714656}}]},{"address":{"type":"absolute","value":5368714720},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368714720}}]},{"address":{"type":"absolute","value":5368714816},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368714816}},{"address":{"type":"absolute","value":5368714890}},{"address":{"type":"absolute","value":5368714920}}]},{"address":{"type":"absolute","value":5368714960},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368714960}},{"address":{"type":"absolute","value":5368715047}},{"address":{"type":"absolute","value":5368715077}}]},{"address":{"type":"absolute","value":5368715152},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368715293}}]},{"address":{"type":"absolute","value":5368715360},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368715360}},{"address":{"type":"absolute","value":5368715378}},{"address":{"type":"absolute","value":5368715481}}]},{"address":{"type":"absolute","value":5368715504},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368715749}}]},{"address":{"type":"absolute","value":5368715792},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368715792}},{"address":{"type":"absolute","value":5368716064}},{"address":{"type":"absolute","value":5368716161}},{"address":{"type":"absolute","value":5368716201}},{"address":{"type":"absolute","value":5368716226}},{"address":{"type":"absolute","value":5368716255}}]},{"address":{"type":"absolute","value":5368716336},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368716336}},{"address":{"type":"absolute","value":5368716455}},{"address":{"type":"absolute","value":5368716477}},{"address":{"type":"absolute","value":5368716530}},{"address":{"type":"absolute","value":5368716679}},{"address":{"type":"absolute","value":5368716781}},{"address":{"type":"absolute","value":5368716795}},{"address":{"type":"absolute","value":5368716826}},{"address":{"type":"absolute","value":5368716871}},{"address":{"type":"absolute","value":5368716896}},{"address":{"type":"absolute","value":5368716941}},{"address":{"type":"absolute","value":5368716972}},{"address":{"type":"absolute","value":5368717020}},{"address":{"type":"absolute","value":5368717045}},{"address":{"type":"absolute","value":5368717076}}]},{"address":{"type":"absolute","value":5368717152},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368717152}},{"address":{"type":"absolute","value":5368717621}}]},{"address":{"type":"absolute","value":5368717728},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368717728}},{"address":{"type":"absolute","value":5368717748}},{"address":{"type":"absolute","value":5368717763}}]},{"address":{"type":"absolute","value":5368718000},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368718025}},{"address":{"type":"absolute","value":5368718495}}]},{"address":{"type":"absolute","value":5368718608},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368718608}},{"address":{"type":"absolute","value":5368718713}},{"address":{"type":"absolute","value":5368718771}},{"address":{"type":"absolute","value":5368718836}},{"address":{"type":"absolute","value":5368718885}},{"address":{"type":"absolute","value":5368718922}}]},{"address":{"type":"absolute","value":5368719072},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368719108}},{"address":{"type":"absolute","value":5368719138}}]},{"address":{"type":"absolute","value":5368719184},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368719184}}]},{"address":{"type":"absolute","value":5368721368},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368721368}}]},{"address":{"type":"absolute","value":5368722380},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368722407}},{"address":{"type":"absolute","value":5368722422}},{"address":{"type":"absolute","value":5368722456}}]},{"address":{"type":"absolute","value":5368722572},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368722612}},{"address":{"type":"absolute","value":5368722621}}]},{"address":{"type":"absolute","value":5368722632},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368722672}},{"address":{"type":"absolute","value":5368722681}}]},{"address":{"type":"absolute","value":5368723072},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368723072}},{"address":{"type":"absolute","value":5368723206}},{"address":{"type":"absolute","value":5368723482}}]},{"address":{"type":"absolute","value":5368723816},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368723816}},{"address":{"type":"absolute","value":5368723854}}]},{"address":{"type":"absolute","value":5368724092},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368724092}},{"address":{"type":"absolute","value":5368724192}}]},{"address":{"type":"absolute","value":5368724368},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368724494}}]},{"address":{"type":"absolute","value":5368724742},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368724742}}]},{"address":{"type":"absolute","value":5368724816},"matched_basic_blocks":[{"address":{"type":"absolute","value":5368723816}},{"address":{"type":"absolute","value":5368723854}}]}]},"feature_counts":{"file":1265,"functions":[{"address":{"type":"absolute","value":5368713216},"count":30},{"address":{"type":"absolute","value":5368713276},"count":23},{"address":{"type":"absolute","value":5368713344},"count":8},{"address":{"type":"absolute","value":5368713360},"count":32},{"address":{"type":"absolute","value":5368713440},"count":98},{"address":{"type":"absolute","value":5368713808},"count":39},{"address":{"type":"absolute","value":5368713888},"count":34},{"address":{"type":"absolute","value":5368713952},"count":8},{"address":{"type":"absolute","value":5368713984},"count":8},{"address":{"type":"absolute","value":5368714096},"count":37},{"address":{"type":"absolute","value":5368714192},"count":31},{"address":{"type":"absolute","value":5368714272},"count":31},{"address":{"type":"absolute","value":5368714368},"count":29},{"address":{"type":"absolute","value":5368714464},"count":38},{"address":{"type":"absolute","value":5368714656},"count":30},{"address":{"type":"absolute","value":5368714720},"count":30},{"address":{"type":"absolute","value":5368714784},"count":15},{"address":{"type":"absolute","value":5368714816},"count":47},{"address":{"type":"absolute","value":5368714944},"count":8},{"address":{"type":"absolute","value":5368714960},"count":52},{"address":{"type":"absolute","value":5368715136},"count":8},{"address":{"type":"absolute","value":5368715152},"count":68},{"address":{"type":"absolute","value":5368715360},"count":50},{"address":{"type":"absolute","value":5368715504},"count":75},{"address":{"type":"absolute","value":5368715792},"count":124},{"address":{"type":"absolute","value":5368716336},"count":124},{"address":{"type":"absolute","value":5368717152},"count":125},{"address":{"type":"absolute","value":5368717728},"count":31},{"address":{"type":"absolute","value":5368718000},"count":86},{"address":{"type":"absolute","value":5368718608},"count":87},{"address":{"type":"absolute","value":5368718976},"count":12},{"address":{"type":"absolute","value":5368718992},"count":15},{"address":{"type":"absolute","value":5368719040},"count":19},{"address":{"type":"absolute","value":5368719072},"count":32},{"address":{"type":"absolute","value":5368719184},"count":19},{"address":{"type":"absolute","value":5368719216},"count":8},{"address":{"type":"absolute","value":5368720021},"count":8},{"address":{"type":"absolute","value":5368721436},"count":9},{"address":{"type":"absolute","value":5368721880},"count":10},{"address":{"type":"absolute","value":5368721896},"count":9},{"address":{"type":"absolute","value":5368721900},"count":7},{"address":{"type":"absolute","value":5368721908},"count":7},{"address":{"type":"absolute","value":5368721944},"count":11},{"address":{"type":"absolute","value":5368721956},"count":7},{"address":{"type":"absolute","value":5368721964},"count":7},{"address":{"type":"absolute","value":5368721972},"count":9},{"address":{"type":"absolute","value":5368722372},"count":9},{"address":{"type":"absolute","value":5368722380},"count":52},{"address":{"type":"absolute","value":5368722464},"count":11},{"address":{"type":"absolute","value":5368722572},"count":35},{"address":{"type":"absolute","value":5368722632},"count":34},{"address":{"type":"absolute","value":5368723072},"count":113},{"address":{"type":"absolute","value":5368723868},"count":8},{"address":{"type":"absolute","value":5368723874},"count":8},{"address":{"type":"absolute","value":5368723886},"count":8},{"address":{"type":"absolute","value":5368723892},"count":8},{"address":{"type":"absolute","value":5368723898},"count":8},{"address":{"type":"absolute","value":5368723904},"count":8},{"address":{"type":"absolute","value":5368723910},"count":8},{"address":{"type":"absolute","value":5368723916},"count":8},{"address":{"type":"absolute","value":5368723922},"count":8},{"address":{"type":"absolute","value":5368723928},"count":8},{"address":{"type":"absolute","value":5368723934},"count":8},{"address":{"type":"absolute","value":5368723940},"count":8},{"address":{"type":"absolute","value":5368723946},"count":8},{"address":{"type":"absolute","value":5368723952},"count":8},{"address":{"type":"absolute","value":5368723958},"count":8},{"address":{"type":"absolute","value":5368723970},"count":8},{"address":{"type":"absolute","value":5368723976},"count":8},{"address":{"type":"absolute","value":5368723988},"count":8},{"address":{"type":"absolute","value":5368723994},"count":8},{"address":{"type":"absolute","value":5368724006},"count":8},{"address":{"type":"absolute","value":5368724012},"count":8},{"address":{"type":"absolute","value":5368724018},"count":8},{"address":{"type":"absolute","value":5368724024},"count":8},{"address":{"type":"absolute","value":5368724030},"count":8},{"address":{"type":"absolute","value":5368724080},"count":9},{"address":{"type":"absolute","value":5368724092},"count":52},{"address":{"type":"absolute","value":5368724219},"count":8},{"address":{"type":"absolute","value":5368724225},"count":8},{"address":{"type":"absolute","value":5368724288},"count":8},{"address":{"type":"absolute","value":5368724368},"count":50},{"address":{"type":"absolute","value":5368724742},"count":20},{"address":{"type":"absolute","value":5368724816},"count":37}]},"library_functions":[{"address":{"type":"absolute","value":5368713308},"name":"??__E_afxInitAppState@@YAXXZ"},{"address":{"type":"absolute","value":5368713968},"name":"?"},{"address":{"type":"absolute","value":5368714000},"name":"?RestoreAutosavedFilesAtRestart@CWinApp@@UEBAHXZ"},{"address":{"type":"absolute","value":5368714016},"name":"?ReopenPreviousFilesAtRestart@CWinApp@@UEBAHXZ"},{"address":{"type":"absolute","value":5368714032},"name":"?SupportsAutosaveAtInterval@CWinApp@@UEBAHXZ"},{"address":{"type":"absolute","value":5368714048},"name":"?SupportsAutosaveAtRestart@CWinApp@@UEBAHXZ"},{"address":{"type":"absolute","value":5368714064},"name":"?SupportsApplicationRecovery@CWinApp@@UEBAHXZ"},{"address":{"type":"absolute","value":5368714080},"name":"?SupportsRestartManager@CWinApp@@UEBAHXZ"},{"address":{"type":"absolute","value":5368714432},"name":"?what@exception@std@@UEBAPEBDXZ"},{"address":{"type":"absolute","value":5368714544},"name":"??0bad_array_new_length@std@@QEAA@XZ"},{"address":{"type":"absolute","value":5368714624},"name":"?_Throw_bad_array_new_length@std@@YAXXZ"},{"address":{"type":"absolute","value":5368715776},"name":"?"},{"address":{"type":"absolute","value":5368717808},"name":"?"},{"address":{"type":"absolute","value":5368717904},"name":"?"},{"address":{"type":"absolute","value":5368720120},"name":"?pre_c_initialization@@YAHXZ"},{"address":{"type":"absolute","value":5368720304},"name":"?post_pgo_initialization@@YAHXZ"},{"address":{"type":"absolute","value":5368720320},"name":"?pre_cpp_initialization@@YAXXZ"},{"address":{"type":"absolute","value":5368720348},"name":"?__scrt_common_main_seh@@YAHXZ"},{"address":{"type":"absolute","value":5368720720},"name":"mainCRTStartup"},{"address":{"type":"absolute","value":5368720768},"name":"__security_check_cookie"},{"address":{"type":"absolute","value":5368720800},"name":"__scrt_acquire_startup_lock"},{"address":{"type":"absolute","value":5368720860},"name":"__scrt_initialize_crt"},{"address":{"type":"absolute","value":5368720936},"name":"__scrt_initialize_onexit_tables"},{"address":{"type":"absolute","value":5368721076},"name":"__scrt_is_nonwritable_in_current_image"},{"address":{"type":"absolute","value":5368721228},"name":"__scrt_release_startup_lock"},{"address":{"type":"absolute","value":5368721264},"name":"__scrt_uninitialize_crt"},{"address":{"type":"absolute","value":5368721308},"name":"_onexit"},{"address":{"type":"absolute","value":5368721368},"name":"atexit"},{"address":{"type":"absolute","value":5368721392},"name":"??_Gtype_info@@UEAAPEAXI@Z"},{"address":{"type":"absolute","value":5368721444},"name":"?__scrt_initialize_thread_safe_statics@@YAHXZ"},{"address":{"type":"absolute","value":5368721652},"name":"?__scrt_uninitialize_thread_safe_statics@@YAXXZ"},{"address":{"type":"absolute","value":5368721692},"name":"__security_init_cookie"},{"address":{"type":"absolute","value":5368721864},"name":"?"},{"address":{"type":"absolute","value":5368721872},"name":"?"},{"address":{"type":"absolute","value":5368721916},"name":"__scrt_initialize_default_local_stdio_options"},{"address":{"type":"absolute","value":5368721980},"name":"__scrt_fastfail"},{"address":{"type":"absolute","value":5368722312},"name":"__scrt_get_show_window_mode"},{"address":{"type":"absolute","value":5368722480},"name":"__scrt_unhandled_exception_filter"},{"address":{"type":"absolute","value":5368722692},"name":"__raise_securityfailure"},{"address":{"type":"absolute","value":5368722744},"name":"__report_gsfailure"},{"address":{"type":"absolute","value":5368722956},"name":"capture_previous_context"},{"address":{"type":"absolute","value":5368723500},"name":"_Curl_tls_keylog_enabled"},{"address":{"type":"absolute","value":5368723512},"name":"__GSHandlerCheck"},{"address":{"type":"absolute","value":5368723544},"name":"__GSHandlerCheckCommon"},{"address":{"type":"absolute","value":5368723648},"name":"??0CAtlBaseModule@ATL@@QEAA@XZ"},{"address":{"type":"absolute","value":5368723816},"name":"??1CAtlBaseModule@ATL@@QEAA@XZ"},{"address":{"type":"absolute","value":5368724036},"name":"?AfxInitialize@@YAHHK@Z"},{"address":{"type":"absolute","value":5368724256},"name":"_guard_dispatch_icall_nop"},{"address":{"type":"absolute","value":5368724620},"name":"?"},{"address":{"type":"absolute","value":5368724772},"name":"__scrt_is_nonwritable_in_current_image$filt$0"}]}},"rules":{"contain loop":{"meta":{"name":"contain loop","authors":["moritz.raabe@mandiant.com"],"scopes":{"static":"function"},"attack":[],"mbc":[],"references":[],"examples":["08AC667C65D36D6542917655571E61C8:0x406EAA"],"description":"","lib":true,"is_subscope_rule":false,"maec":{}},"source":"rule:\r\n  meta:\r\n    name: contain loop\r\n    authors:\r\n      - moritz.raabe@mandiant.com\r\n    lib: true\r\n    scopes:\r\n      static: function\r\n      dynamic: unsupported  # requires characteristic features\r\n    examples:\r\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\r\n  features:\r\n    - or:\r\n      - characteristic: loop\r\n      - characteristic: tight loop\r\n      - characteristic: recursive call\r\n","matches":[[{"type":"absolute","value":5368715792},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":5368715792}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":5368716336},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":5368716336}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":5368717152},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":5368717312}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":5368718000},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":5368718064}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":5368722572},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":5368722572}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":5368722632},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":5368722632}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"parse PE header":{"meta":{"name":"parse PE header","namespace":"load-code/pe","authors":["moritz.raabe@mandiant.com"],"scopes":{"static":"function"},"attack":[{"parts":["Execution","Shared Modules"],"tactic":"Execution","technique":"Shared Modules","subtechnique":"","id":"T1129"}],"mbc":[],"references":[],"examples":["9324D1A8AE37A36AE560C37448C9705A:0x403DD0"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\r\n  meta:\r\n    name: parse PE header\r\n    namespace: load-code/pe\r\n    authors:\r\n      - moritz.raabe@mandiant.com\r\n    scopes:\r\n      static: function\r\n      dynamic: unsupported  # requires mnemonic, operand[1].offset features\r\n    att&ck:\r\n      - Execution::Shared Modules [T1129]\r\n    examples:\r\n      - 9324D1A8AE37A36AE560C37448C9705A:0x403DD0\r\n  features:\r\n    - and:\r\n      - os: windows\r\n      - and:\r\n        - mnemonic: cmp\r\n        - or:\r\n          - number: 0x4550 = IMAGE_NT_SIGNATURE (PE)\r\n          - and:\r\n            - number: 0x50\r\n            - number: 0x45\r\n        - or:\r\n          - number: 0x5A4D = IMAGE_DOS_SIGNATURE (MZ)\r\n          - and:\r\n            - number: 0x4D\r\n            - number: 0x5A\r\n        - optional:\r\n          - and:\r\n            - operand[1].offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\r\n            - or:\r\n              - and:\r\n                - arch: i386\r\n                - operand[1].offset: 0x50 = IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage\r\n                - operand[1].offset: 0x34 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\r\n              - and:\r\n                - arch: amd64\r\n                - operand[1].offset: 0x50 = IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage\r\n                - operand[1].offset: 0x30 = IMAGE_NT_HEADERS64.OptionalHeader.ImageBase\r\n          - basic block:\r\n            - and:\r\n              - operand[1].offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\r\n              - 3 or more:\r\n                - operand[1].offset: 0x4 = IMAGE_NT_HEADERS.FileHeader.Machine\r\n                - operand[1].offset: 0x6 = IMAGE_NT_HEADERS.FileHeader.NumberOfSections\r\n                - operand[1].offset: 0x14 = IMAGE_NT_HEADERS.FileHeader.SizeOfOptionalHeader\r\n                - operand[1].offset: 0x16 = IMAGE_NT_HEADERS.FileHeader.Characteristics\r\n                - operand[1].offset: 0x28 = IMAGE_NT_HEADERS.OptionalHeader.AddressOfEntryPoint  # for 32 and 64 bit\r\n                - or:\r\n                  - and:\r\n                    - arch: i386\r\n                    - operand[1].offset: 0x34 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\r\n                    - operand[1].offset: 0x50 = IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage\r\n                  - and:\r\n                    - arch: amd64\r\n                    - operand[1].offset: 0x30 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\r\n                    - operand[1].offset: 0x50 = IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage\r\n","matches":[[{"type":"absolute","value":5368722380},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"cmp"}},"children":[],"locations":[{"type":"absolute","value":5368722433},{"type":"absolute","value":5368722402},{"type":"absolute","value":5368722442},{"type":"absolute","value":5368722427},{"type":"absolute","value":5368722414}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":17744,"description":"IMAGE_NT_SIGNATURE (PE)"}},"children":[],"locations":[{"type":"absolute","value":5368722414}],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":80}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":69}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":23117,"description":"IMAGE_DOS_SIGNATURE (MZ)"}},"children":[],"locations":[{"type":"absolute","value":5368722397}],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":77}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":90}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"operand offset","index":1,"operand_offset":60,"description":"IMAGE_DOS_HEADER.e_lfanew"}},"children":[],"locations":[{"type":"absolute","value":5368722407}],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"operand offset","index":1,"operand_offset":80,"description":"IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"operand offset","index":1,"operand_offset":52,"description":"IMAGE_NT_HEADERS.OptionalHeader.ImageBase"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"operand offset","index":1,"operand_offset":80,"description":"IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"operand offset","index":1,"operand_offset":48,"description":"IMAGE_NT_HEADERS64.OptionalHeader.ImageBase"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"parse PE header/3a0d016707f44fa5b41262f634a21c96"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"contains PDB path":{"meta":{"name":"contains PDB path","namespace":"executable/pe/pdb","authors":["moritz.raabe@mandiant.com"],"scopes":{"static":"file","dynamic":"file"},"attack":[],"mbc":[],"references":[],"examples":["464EF2CA59782CE697BC329713698CCC"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\r\n  meta:\r\n    name: contains PDB path\r\n    namespace: executable/pe/pdb\r\n    authors:\r\n      - moritz.raabe@mandiant.com\r\n    scopes:\r\n      static: file\r\n      dynamic: file\r\n    examples:\r\n      - 464EF2CA59782CE697BC329713698CCC  # level32.exe\r\n  features:\r\n    - string: /:\\\\.*\\.pdb/\r\n","matches":[[{"type":"no address"},{"success":true,"node":{"type":"feature","feature":{"type":"regex","regex":"/:\\\\.*\\.pdb/"}},"children":[],"locations":[{"type":"file","value":22216}],"captures":{"C:\\Users\\user\\OneDrive\\Desktop\\babycmp\\x64\\Release\\babycmp.pdb":[{"type":"file","value":22216}]}}]]},"reference analysis tools strings":{"meta":{"name":"reference analysis tools strings","namespace":"anti-analysis","authors":["michael.hunhoff@mandiant.com"],"scopes":{"static":"file","dynamic":"file"},"attack":[],"mbc":[{"parts":["Discovery","Analysis Tool Discovery","Process detection"],"objective":"Discovery","behavior":"Analysis Tool Discovery","method":"Process detection","id":"B0013.001"}],"references":["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiAnalysis/process.cpp"],"examples":["al-khaser_x86.exe_"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\r\n  meta:\r\n    name: reference analysis tools strings\r\n    namespace: anti-analysis\r\n    authors:\r\n      - michael.hunhoff@mandiant.com\r\n    scopes:\r\n      static: file\r\n      dynamic: file\r\n    mbc:\r\n      - Discovery::Analysis Tool Discovery::Process detection [B0013.001]\r\n    references:\r\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiAnalysis/process.cpp\r\n    examples:\r\n      - al-khaser_x86.exe_\r\n  features:\r\n    - or:\r\n      - string: /ollydbg(\\.exe)?/i\r\n      - string: /ProcessHacker(\\.exe)?/i\r\n      - string: /tcpview(\\.exe)?/i\r\n      - string: /autoruns(\\.exe)?/i\r\n      - string: /autorunsc(\\.exe)?/i\r\n      - string: /filemon(\\.exe)?/i\r\n      - string: /procmon(\\.exe)?/i\r\n      - string: /regmon(\\.exe)?/i\r\n      - string: /procexp(\\.exe)?/i\r\n      - string: /(?<!\\w)ida[gqtuw]?(\\.exe)?$/i\r\n      - string: /ida[gqtuw]?64(\\.exe)?$/i\r\n      - string: /ImmunityDebugger(\\.exe)?/i\r\n      - string: /Wireshark(\\.exe)?/i\r\n      - string: /dumpcap(\\.exe)?/i\r\n      - string: /HookExplorer(\\.exe)?/i\r\n      - string: /ImportREC(\\.exe)?/i\r\n      - string: /PETools(\\.exe)?/i\r\n      - string: /LordPE(\\.exe)?/i\r\n      - string: /SysInspector(\\.exe)?/i\r\n      - string: /proc_analyzer(\\.exe)?/i\r\n      - string: /sysAnalyzer(\\.exe)?/i\r\n      - string: /sniff_hit(\\.exe)?/i\r\n      - string: /windbg(\\.exe)?/i\r\n      - string: /joeboxcontrol(\\.exe)?/i\r\n      - string: /joeboxserver(\\.exe)?/i\r\n      - string: /ResourceHacker(\\.exe)?/i\r\n      - string: /x32dbg(\\.exe)?/i\r\n      - string: /x64dbg(\\.exe)?/i\r\n      - string: /Fiddler(\\.exe)?/i\r\n      - string: /httpdebugger(\\.exe)?/i\r\n      - string: /fakenet(\\.exe)?/i\r\n      - string: /netmon(\\.exe)?/i\r\n      - string: /WPE PRO(\\.exe)?/i\r\n      - string: /decompile(\\.exe)?/i\r\n      - string: /scylla/i\r\n      - string: /megadumper/i\r\n","matches":[[{"type":"no address"},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/ollydbg(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/ProcessHacker(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/tcpview(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/autoruns(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/autorunsc(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/filemon(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/procmon(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/regmon(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/procexp(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"regex","regex":"/(?<!\\w)ida[gqtuw]?(\\.exe)?$/i"}},"children":[],"locations":[{"type":"file","value":52401},{"type":"file","value":60605}],"captures":{"IDAT":[{"type":"file","value":52401},{"type":"file","value":60605}]}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/ida[gqtuw]?64(\\.exe)?$/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/ImmunityDebugger(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/Wireshark(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/dumpcap(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/HookExplorer(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/ImportREC(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/PETools(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/LordPE(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/SysInspector(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/proc_analyzer(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/sysAnalyzer(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/sniff_hit(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/windbg(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/joeboxcontrol(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/joeboxserver(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/ResourceHacker(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/x32dbg(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/x64dbg(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/Fiddler(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/httpdebugger(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/fakenet(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/netmon(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/WPE PRO(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/decompile(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/scylla/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/megadumper/i"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]}}}
